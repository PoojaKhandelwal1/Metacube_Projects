<!--
 * ReferenceEdge
 * 
 * Point of Reference, Inc. - Copyright 2014 All rights reserved.
 *
 * @company : Point of Reference, Inc.
 * @website : www.point-of-reference.com
 *
 * Disclaimer: THIS SOFTWARE IS PROVIDED "AS-IS" BY POINT OF REFERENCE ("POR"), 
 * WITH NO REPRESENTATIONS OR WARRANTIES ABOUT THE SUITABILITY OF THE SOFTWARE, 
 * EITHER EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE IMPLIED WARRANTIES 
 * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, OR NON-INFRINGEMENT. 
 * POR SHALL NOT BE LIABLE FOR ANY DAMAGES SUFFERED BY LICENSEE AS A RESULT OF USING, 
 * MODIFYING OR DISTRIBUTING THIS SOFTWARE OR ITS DERIVATIVES. POR IS NOT LIABLE FOR, 
 * AND MAKES NO REPRESENTATIONS OR WARRANTIES REGARDING, THE ACTIONS OR OMISSIONS OF 
 * ANY THIRD PARTIES (OR THE PRODUCTS OR SERVICES OFFERED BY ANY THIRD PARTIES) INCLUDING, 
 * WITHOUT LIMIATION, SALESFORCE.COM. COPY, USE OR DISTRIBUTION PROHIBITED WITHOUT EXPRESS 
 * WRITTEN CONSENT FROM COMPANY.
 -->   
<apex:page controller="RfSearchController" id="pageId" sidebar="false" tabStyle="Ref_Search__tab" action="{!userInvitaionMappingRecord}">
    <!-- Messages -->
    <apex:pageMessages id="pgmsgId"/>
    <apex:pageMessage summary="{!$Label.User_License}" strength="3" severity="Info" rendered="{!NOT(isFullLicenseAccessible)}" />
    <c:POR_ModalLoader id="PORLoader"/>
    <apex:stylesheet value="{!URLFOR($Resource.JqueryFiles, 'jquery-ui-1.9.2.custom.min.css')}"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <apex:includeScript value="{!URLFOR($Resource.BootstrapFiles,'bootstrap.js')}"/>
<!--     <apex:stylesheet value="{!URLFOR($Resource.BootstrapFiles,'bootstrap.css')}"/> -->
    <!-- Add CSS-->
    <style type="text/css">
      <!-- Css Changes Starts hear- REF-1320 --> 
        .ui-dialog-titlebar,.ui-widget-header {
            border: 1px solid #79B4CD !important;
        }
        a {
    		color: black;
    		text-decoration: underline;
		} 
	   	body .pbBody table.list tr.headerRow td, body .pbBody table.list tr.headerRow th { 
			background: #fff;
		    border-right: 1px solid #fff;
		    border-left: 1px solid #fff;
		    text-align: center;
		    border-top-color: #ffffff;
			border-width: 0 0 1px 1px;
		    border-color: #e0e3e5;
		    color: #000;
		    font-size: .9em;
		    font-weight: bold;
		    padding: 15px 2px 15px 5px !important;
		    border-bottom: 2px solid #ccc;
		    white-space: nowrap;
		    border: 0px solid #ededed;
		    /* border-bottom: 2px solid #ccc; */
		    white-space: nowrap;
		    text-align:left;
		}
	 	.list tr:hover {
	        background-color: #F8F8F8 !important;
	        border-color: #F8F8F8 !important;
        }  
        
       .list tr th:nth-child(1) {
	        width: 50px;
	        text-align:center !important;
        }
        .list tr td:nth-child(1) {
	        width: 50px;
	        text-align:center;
        } 
        .list tr td:nth-child(2) {
	        width: 70px;
	        text-align:center;
        } 
        .list tr th:nth-child(3) {
	        width: 50px;
	        text-align:left;
        }
        .list tr td:nth-child(3) {
	        width: 700px;
	        text-align:left;
        } 
        .list tr td:nth-child(3) {
	        width: 700px;
	        text-align:left;
        }  
		.detailList .list th, .apexp .editPage .bPageBlock .detailList .list tr td, .apexp .editPage .bPageBlock .detailList .list tr th {
		    color: rgb(51, 51, 51);
		    padding: 4px 2px 4px 5px;
		    border-bottom: 1px solid #ededed;
		} 
        span#sContent, span#stagAccountName {
	        font-size: 14px;
		    font-weight: normal;
		    color: #000000;
		    font-weight: bold;
		    overflow: hidden;
		    width: 95%;
		    display: inline-block;
		    white-space: nowrap;
		    text-overflow: ellipsis;
        } 
        .my-popover input[type="button"] {
	        background: none;
	        border: none;
	        font-size: 13px;
	        font-weight: normal;
	        position: absolute;
	        right: 6px;
	        top: 12px;
	        color: #9facb1;
        }
        
        .my-popover .description-text {
	        font-size: 14px;
	        margin-top: 20px;
	        padding-left: 5px;
        }
        .my-popover .description-text span{
	        display: block; 
	        margin-top:5px;
	        font-family: Arial,Helvetica,sans-serif;
	        letter-spacing: 0.0611em;
	        color: #666666;
	        max-height: 60px;
	        overflow-y: auto;
	        font-size: 12px;
        }
        
        .my-popover .description-text label {
	        display: block;
		    margin-top: 5px;
		    font-family: Arial,Helvetica,sans-serif;
		    letter-spacing: 0.0611em;
		    color: #666666;
		    max-height: 130px;
		    overflow-y: auto;
		    font-weight: 500;
		    font-size: 12px;
        }
        .my-popover .description-text p{
	        margin-top: 20px;
		    margin-bottom: 0px;
		    line-height: 1.25;
		    text-transform: uppercase;
		    letter-spacing: .0625em;
		    color: #000000;
		    max-height: 130px;
		    font-family: Arial,Helvetica,sans-serif;
		    font-weight: 600;
		    font-size: 10.8px;
        }
        .my-popover .description-text i {
			margin-top: 20px;
			margin-bottom: 0px;
			line-height: 1.25; 
			letter-spacing: .0625em;
			color: #919498;
			max-height: 130px;
			font-family: Arial,Helvetica,sans-serif; 
			font-size: 10.8px;
			font-style: normal;
			font-weight: 500; 
		}
		
        .my-popover .description-text .summary-heading{
        margin-top: 25px;
        }
        body .bPageBlock .pbBody .data2Col {
	        padding-top: 0px;
	        padding-bottom: 0px;
	        border-top: 0px solid #ffffff;
	        background-color: #f8f8f8 !important;
        }
        
        .ui-button-text-only .ui-button-text {
        	padding: .2em 1em !important;
        }
        
        .lookupHoverDetail .userProfileHoverUserBlock .bPageBlock {
        	box-sizing: content-box;
        }
        
        .lookupHoverDetail .accountBlock .bPageBlock {
        	box-sizing: content-box;
        }
         
        img.alert-imgs:nth-child(2) {
        	margin-top: 5px;
        }
        
        .apexp .bPageBlock.apexDefaultPageBlock .pbBody {
        	margin: 0;
        }
         
        td.data2Col.first {
       	 padding: 0 !important;
        }
        body .bPageBlock .pbBody .data2Col {
	        padding-top: 5px;
	        padding-bottom: 0px;
	        border-top: 0px solid #ffffff;
	        background-color: #ffffff;
        }
        thead#accountTableHeader {
        }
        .bPageBlock .detailList .data2Col {
	        padding-top: 2px;
	        /* padding-right: 2px; */
	        padding-bottom: 2px;
	        padding-left: 0px !important;
	        /* text-align: left; */
	        width: 82%;
        }
        
        
        .apexp .detailList .list .headerRow th {
        /* border-bottom: 7px solid #ccc; */
	        text-align: left;
	        white-space: nowrap;
	        background: #fff;
	        border-right: 1px solid #fff;
	        border-left: 1px solid #fff;
	        padding-top: 10px;
	        padding-bottom: 10px;
        }
        .apexp .detailList .list td, .apexp .detailList .list tr  {
	        padding: 11px 12px 11px 5px;
	        color: #333;
        
        } 
        
        body .pbBody table.list tr.dataRow.highlight td, body .pbBody table.list tr.dataRow.highlight th {
	        background-color: #F8F8F8;
	        border-color: #F8F8F8;
        }
        
        .my-popover {
        width: 350px;
/*         height: 287px;   */ 
        padding: 3px 16px 16px 16px;
        max-width: 350px;  
        box-shadow: none; 
        }
        .arrow_box {
        background: #f4f6f9;
        }
        .arrow_box:after {
	        right: 99.5%;
		    top: 34px;
		    border: solid transparent;
		    content: " ";
		    height: 0;
		    width: 0;
		    position: absolute;
		    pointer-events: none;
		    border-color: rgba(244, 246, 249, 0);
		    border-right-color: #f4f6f9;
		    border-width: 15px;
		    margin-top: -15px;
        }
        
        .arrow_box:before {
	        right: 99.8%;
		    top: 41px;
		    border: solid #1797c0;
		    content: " ";
		    height: 0;
		    width: 0;
		    position: absolute;
		    pointer-events: none;
		    border-color: rgba(244, 246, 249, 0);
		    border-right-color: #a7a0a0;
		    border-width: 16px;
		    margin-top: -23px;
        } 
        .arrow_box-left {
        
        background: #f4f6f9;
        
        } 
        .arrow_box-left:before {
        left: 100%;
        top: 34px;
        border: solid transparent;
        content: " ";
        height: 0;
        width: 0;
        position: absolute;
        pointer-events: none;
        border-color: rgba(244, 246, 249, 0);
        border-left-color: #a7a0a0;
        border-width: 16px;
        margin-top: -21px;
        } 
       
		
        .arrow_box-left:after {
        left: 100%;
        top: 29px;
        border: solid transparent;
        content: " ";
        height: 0;
        width: 0;
        position: absolute;
        pointer-events: none;
        border-color: rgba(244, 246, 249, 0);
        border-left-color: #f4f6f9;
        border-width: 15px;
        margin-top: -15px;
        }
        
        .ui-dialog .ui-dialog-content {
        position: relative;
        border: 0;
        padding: .5em 1em;
        background: none;
        overflow: auto;
        zoom: 1;
        padding-right: 2px;
        max-height: 260px !important;
        }
        
        .bPageBlock .detailList th, .bPageBlock .detailList td {
        vertical-align: middle;
        } 
      
        .content-popover {
	        display: none;
	        z-index: 1010; 
	        border: 1px solid #cccccc;
	        border-top-color: rgba(0, 0, 0, 0.2);
	        border-top-style: solid;
	        border-top-width: 1px;
	        border-right-color: rgba(0, 0, 0, 0.2);
	        border-right-style: solid;
	        border-right-width: 1px;
	        border-bottom-color: rgba(0, 0, 0, 0.2);
	        border-bottom-style: solid;
	        border-bottom-width: 1px;
	        border-left-color: rgba(0, 0, 0, 0.2);
	        border-left-style: solid;
	        border-left-width: 1px;
	        border-image-source: initial;
	        border-image-slice: initial;
	        border-image-width: initial;
	        border-image-outset: initial;
	        border-image-repeat: initial;
	        border: 1px solid rgba(0, 0, 0, 0.2);
	        border-top-color: rgba(0, 0, 0, 0.2);
	        border-top-style: solid;
	        border-top-width: 1px;
	        border-right-color: rgba(0, 0, 0, 0.2);
	        border-right-style: solid;
	        border-right-width: 1px;
	        border-bottom-color: rgba(0, 0, 0, 0.2);
	        border-bottom-style: solid;
	        border-bottom-width: 1px;
	        border-left-color: rgba(0, 0, 0, 0.2);
	        border-left-style: solid;
	        border-left-width: 1px;
	        border-image-source: initial;
	        border-image-slice: initial;
	        border-image-width: initial;
	        border-image-outset: initial;
	        border-image-repeat: initial;
	        border-radius: 6px;
	        border-top-left-radius: 6px;
	        border-top-right-radius: 6px;
	        border-bottom-right-radius: 6px;
	        border-bottom-left-radius: 6px; 
        }
        a.boxclose{
            float: right;
            margin-top: -24px;
            cursor: pointer;
            color: #fff;
            border: 1px solid #AEAEAE;
            border-radius: 16px;
            background: #605F61;
            font-size: 23px;
            font-weight: bold;
            display: inline-block;
            line-height: 0px;
            padding: 10px 3px;  
        }
        .collapse {
            display: none;
        }
        .dialogButtonClass{
            margin-left: 3px !important;
            margin-right: 3px !important;
            color: #333 !important;
            border: 1px solid #b5b5b5 !important;
            border-bottom-color: #7f7f7f !important;
            background: #e8e8e9 url('/img/alohaSkin/btn_sprite.png') repeat-x right top !important;
            font-weight: bold !important;
            font-size: .9em !important;
            -moz-border-radius: 3px !important;
            -webkit-border-radius: 3px !important;
            border-radius: 3px !important;
         }
         
        .ui-button-text-only .ui-button-text {
           padding: .2em 1em !important;
        }
        /*REF-1191 */
        .ui-widget { 
		    font-size: 13.3px;
		    font-family: Arial,Helvetica,sans-serif;
		}
		.ui-dialog .ui-dialog-content {
		    position: relative;
		    border: 0;
		    padding: .5em 1em;
		    background: none;
		    overflow: auto;
		    zoom: 1;
		    padding-right: 2px;
		    max-height: 260px !important;
		    background: #f8f8f8;
		}
       .helpTraining {
        position: relative;
        border-radius: .25rem;
        width: 13rem;
        min-height: 2rem;
        z-index: 60;        
       // display: inline-block;              
        font-family: "Salesforce Sans", Arial, sans-serif;
        color: #706e6b;
        display : none;
    }
        
    .arrowHelpTraining {
        background: #f1f3f3;
    }
    .arrowHelpTraining:after {
        bottom: 100%;
        left: 90%;
        border: solid transparent;
        content: " ";
        height: 0;
        width: 0;
        position: absolute;
        pointer-events: none;
        border-color: rgba(244, 246, 249, 0);
        border-bottom-color: #f1f3f3;
        border-width: 11px;
        margin-left: -12px;
        margin-top: -53px;
        }  
      .header {
        padding: 1.65rem;
        /*padding-left: 2.5rem;
        padding-top: 2.5rem;*/
        font-size: .8rem;   
        padding-bottom: 6px; 
    }
    
    .tour {
        padding: 0.5rem; 
        border-radius: 0;
        font-size: .8rem; 
    }
    .tour:hover{
      background-color : #E5F1EE;
        
    }
    
    .help {
        padding: 0.5rem; 
        border-radius: 0;
        font-size: .8rem;
        
    }
    .help:hover{
      background-color : #E5F1EE; 
    }
  
    #helpmessageId{
        position: relative; 
    }    
    </style> 
    <!-- Script-->
    <script>
        var lookupwindow =''; 
        var lookUpWindowOpen = false;
        var contactIds = '{!invitationcontroller.contactIds}';
        var coworkerIds = '{!invitationcontroller.coworkerIds}';
        var searchText = '';
        var previousMsg = '@@@m@@@';
        var previousDate = '@@@d@@@';
        //for Ipad
        var newWin = null; 
        var popupflag = false;
        var currentPgName = '';
        //this method call on mouse over on Image 
        var IE = document.all?true:false;
        var tempX = 0;
        var tempY = 0;
        var counter = 0;
        var msg = '';
        var header = '';
        var content = '';
        var addcls = '';
        var removcls = '';
        var loc = '';
        var frmTop = '';
        var frmLft = '';
        var totlstps='8';
        var helpAssistant = '{!JSENCODE(helpAssistant)}';
        //  REF-1532
        var globalHeaderHeight = 0;
        var isContentShow = true;
        var checkCount = false;
        var checkStep6 = true;
        var checkStep7 = true;
        var checkStep8 = true;
        
        if (jQuery('.globalHeaderBar')[0]) {
            globalHeaderHeight = jQuery("#AppBodyHeader").height() + jQuery("#globalHeaderBar").height();
        } else {            
            globalHeaderHeight = jQuery("#AppBodyHeader").height();
        }


		jQuery( document ).ready(function() { 

    		if ('{!showInviationOveray}' == 'true') { 
                rfSearchTour();
            }

            jQuery("body").click(function(e){  
                
                if (jQuery(e.target).attr("rel") != "helpTraining_popup") {
                    jQuery(".helpTraining").hide();
                } 
            });
		});

        function rfSearchTour() {
            jQuery(".helpTraining").hide();
            /* REF-1572
            objective : To show HelpOverlays
            modified By : Rajesh 29 May 2018
            */ 
            counter = 0;
            msg = '';
            header = '';
            content = '';
            addcls = '';
            removcls = '';
            loc = '';
            frmTop = '';
            frmLft = '';
            //totlstps='8';
            checkStep6 = true;
            checkStep7 = true;
            checkStep8 = true;

            if (isContentHide == 'true') {
                totlstps='8'
                checkCount =true;
            } else {
                totlstps=7;
             }
            ShowOrHideComponent(true);
        }
            
        function rfSearchHelp() {
            jQuery(".helpTraining").hide(); 
            window.open('{!URLFOR($Resource.RFSearchHelp, "RFSearchHelp/Invitation.html")}','_blank'); 
        } 

		function ShowOrHideComponent(action) {  
            counter ++; 
			jQuery(window).scrollTop(0); 
            
			if (action) {
                var helpOverlayMapInvitation = JSON.parse('{!JSENCODE(helpOverlayInvitation)}');

				if (counter == 1) { 
					jQuery(window).scrollTop(0);  
					msg = helpAssistant + ' ' + JSON.parse('"' + helpOverlayMapInvitation[1].value + '"');
					header = helpOverlayMapInvitation[1].header;
					content = msg.replace('@@@', totlstps);
					addcls = '';
					removcls = 'arrow_compbox arrow_box_top arrow_box_top_right arrow_box_top_Corner';
					loc = 'imglookup';
					frmTop = 51 - globalHeaderHeight;;
					frmLft = '-350';
					
				} else if(counter == 2) {    
					header = helpOverlayMapInvitation[2].header;
					content = JSON.parse('"' + helpOverlayMapInvitation[2].value + '"');
					addcls = 'arrow_box_top_right';
					removcls = 'arrow_box_top arrow_box_top_right arrow_box_top_Corner';
					loc = 'imglookup'; 
					frmTop = -15 - globalHeaderHeight;
					frmLft = '-376';
					
				} else if(counter == 3) { 
					window.scrollBy(0, jQuery('#imglookup').offset().top + 50); 
					header = helpOverlayMapInvitation[3].header;
					content = JSON.parse('"' + helpOverlayMapInvitation[3].value + '"');
					addcls = 'arrow_compbox';
					removcls = 'arrow_box_top_right arrow_compbox arrow_box_top_Corner arrow_box_top_right';
					loc = 'invSetting'; 
					frmTop = -13 - globalHeaderHeight;
					frmLft = '0';
					
				} else if(counter == 4) {
                	window.scrollBy(0, jQuery('#imglookup').offset().top + 250);
					header = helpOverlayMapInvitation[4].header;
					content = JSON.parse('"' + helpOverlayMapInvitation[4].value + '"');
					addcls = 'arrow_box_bottom';
					removcls = 'arrow_compbox arrow_compbox arrow_box_top arrow_box_top_Corner';
					loc = 'divReq'; 
					frmTop = -231 - globalHeaderHeight;
					frmLft = -9; 
					
				} else if(isContentHide == 'true' && checkCount) {  
                    window.scrollBy(0, jQuery('#imglookup').offset().top + 250);
					header = helpOverlayMapInvitation[5].header;
					content = JSON.parse('"' + helpOverlayMapInvitation[5].value + '"');
					addcls = 'arrow_compbox';
					removcls = 'arrow_box_bottom arrow_box_bottom arrow_compbox arrow_box_top arrow_box_top_Corner';
					loc = 'divContnet';  
					frmTop = -38 - globalHeaderHeight;;  
					frmLft = 185;   
					checkCount = false;
				} else if(checkStep6) {  
                    window.scrollBy(0, jQuery('#divReq').offset().top);
					header = helpOverlayMapInvitation[6].header;
					content = JSON.parse('"' + helpOverlayMapInvitation[6].value + '"');
					addcls = 'arrow_box_top';
					removcls = 'arrow_compbox arrow_compbox arrow_box_top arrow_box_top_Corner';  
					loc = 'divReq';  
					frmTop = 68 - globalHeaderHeight;;  
					frmLft = 69; 
					checkStep6 = false;
				} else if(checkStep7) { 
                    window.scrollBy(0, jQuery('#imglookup').offset().top + 250);
					header = helpOverlayMapInvitation[7].header;
					content = JSON.parse('"' + helpOverlayMapInvitation[7].value + '"');
					addcls = 'arrow_compbox';
					removcls = 'arrow_box_top arrow_box_top arrow_box_top_right arrow_box_top_Corner'; 
					loc = 'divReq';  
					frmTop = 7 - globalHeaderHeight;;  
					frmLft = 99;
                    checkStep7 = false;
					
				} else if(checkStep8) {   
					header = helpOverlayMapInvitation[8].header;
					content = JSON.parse('"' + helpOverlayMapInvitation[8].value + '"');
					addcls = 'arrow_box_top';
					removcls = 'arrow_compbox arrow_compbox arrow_box_top arrow_box_top_right';
					loc = 'dvButton'; 
					frmTop = 36 - globalHeaderHeight;;
					frmLft = -6; 
					checkStep8= false;
				} else { 
					action = false;   
			}
			} else {
				action = false;
			} 
			showHideHelpOverlays(action, header, content, loc, addcls, removcls, totlstps, frmTop, frmLft); 
		}
        

        function showDiv(contentId, refconId, e, id) {     
            /*if (IE) { 
                tempX = e.clientX + document.body.scrollLeft;
                tempY = e.clientY + document.body.scrollTop;
            } 
            else {  
                tempX = e.pageX;
                tempY = e.pageY;
            }*/
            tempX = jQuery("#" + id).offset().left + 17;
			tempY = jQuery("#" + id).offset().top + 108 - globalHeaderHeight; 
            fetchContentItem(contentId, refconId);
        } 
        
        //this method call on mouse out on Image 
        function hideDiv() {
            document.getElementById('pageId:frmId:dvContentDetails').style.display = 'none';
        }
        
        // Method to open Link 
		function openContent(id, url, type, isView) {
			 
			if (type != 'LINK' || isView) {
				//incrementRefContentViewCount(); 
				window.open('/' + id, '_blank');
			} else {
				//incrementRefContentOpenCount(); 
				openLinkContent(url); 
			} 
		}
		
        
        //Method to open Link
        function openLinkContent(contentUrl) {
            if (contentUrl.indexOf("http://")>=0 || contentUrl.indexOf("https://")>=0) 
                window.open('','_blank').location.href = contentUrl;
            else
                window.open('','_blank').location.href = 'http://'+contentUrl;
        }
        function ShowLookup(currentPageName){
            if(!lookUpWindowOpen){
                lookUpWindowOpen = true;
                
                // Get the user agent string & device Name
                var deviceAgent = navigator.userAgent;
                var ios = deviceAgent.toLowerCase().match(/(iphone|ipod|ipad)/);
                    popupflag = true;
                    currentPgName = currentPageName;
                    
                    if(currentPageName == '{!$Page.InvitationContactsLookup}'){
                        newWin = window.open(encodeURI(currentPageName + '?strText=' + contactIds),'Popup','height=500,width=700,left=100,top=100,resizable=no,scrollbars=yes,toolbar=no,status=no'); 
                    }
                    else if(currentPageName == '{!$Page.InvitationCoworkersLookup}'){
                        newWin = window.open(encodeURI(currentPageName + '?strText=' + coworkerIds),'Popup','height=500,width=700,left=100,top=100,resizable=no,scrollbars=yes,toolbar=no,status=no');
                    }
                lookUpWindowOpen = false;
            }  
            return false;                              
        } 
        
        function closePopup(recepientIds, EmailIds){   
            if (null != newWin){  
                newWin.close(); 
                if(typeof EmailIds != 'undefined'){
                    if(popupflag){
                        if(currentPgName == '{!$Page.InvitationContactsLookup}'){
                            document.getElementById("pageId:frmId:pbId:pbsId2:pbsConItemId:txtContacts").value = EmailIds;
                            contactIds = recepientIds;
                            PORShowLoading();
                            jsSetContactEmailIds(EmailIds,contactIds);
                        }
                        if(currentPgName == '{!$Page.InvitationCoworkersLookup}'){
                            document.getElementById("pageId:frmId:pbId:pbsId2:pbsCoworkerItemId:txtCoworker").value = EmailIds;
                            coworkerIds = recepientIds;
                            PORShowLoading();
                            jsSetCoworkerEmailIds(EmailIds,coworkerIds);
                        }
                        popupflag = false;
                    }
                }
            }    
        } 
        
        function  assignParameters(){
            jsDoneAction(); 
        }
        
        function  checkTemplate(){
            var temp = document.getElementById('pageId:frmId:pbId:pbsId3:pbsCTId:microSiteId').value;
            if(temp.trim() == ''){
                alert('{!$Label.SELECT_MICROSITE}');
                return false;
            }
            else
                jsSetDefaultTemplate();
        }
        
        
        function jsAction() {
            previewEmailJs();
            return false;
        }
        
        function jsShowRefContents(){
            showRefContents();
        }
        
        PORShowLoading();
        jQuery(window).load(function() { 
            PORHideLoading(); 
            
        });
        
         /*
         *  re #119 This function will show Disolving Alert for sales reward
         */
		function showDisolvingAlert(){
			var points = jQuery("input[id*='rewardPoints']").val();
			var message = jQuery("input[id*='actionMessage']").val(); 
			if(typeof points !='undefined' && points!='' && points!='0')  
				notification(points,message); 
		}
		function redirectToBack(){ 
		}
		
		// re #956
		jQuery("body").click(function(e){ 
			if(jQuery(e.target).attr("rel") != "content-popup-ui"){
				jQuery("#divContentPopupover").hide();
			}
		});
		
    </script>
    <apex:outputPanel id="micrositePanelId">
        <script>
            function previewMicrosite(){
                var temp = document.getElementById('pageId:frmId:pbId:pbsId3:pbsCTId:microSiteId').value;
                if(temp.trim() == ''){
                    alert('{!$Label.SELECT_MICROSITE}');
                    return false;
                } else {
                    window.open('{!$Page.PreviewMicrositeNew}?micrositeId='+temp+'&selectRefContent={!URLENCODE(invitationcontroller.selectedRefContents)}&internalPreview=true' ,'_blank');
                }
            }
        </script>
    </apex:outputPanel>
    <!-- Form -->
    <!-- Load for related content Popover- #943 --> 
		<apex:outputPanel id="loadContent">
			<script>
			function PopoverHide() {  
				jQuery(".content-popover").hide();
			  
			}
		
			function showDivOncompleteAction() {
        	jQuery("#btnOpen").hide();
			jQuery("#btnDownload").hide();
			jQuery("#btnView").hide(); 
            document.getElementById('pageId:frmId:dvContentDetails').style.display = 'block';
            document.getElementById('pageId:frmId:dvContentDetails').style.left = (tempX + 18) +'px';
            document.getElementById('pageId:frmId:dvContentDetails').style.top = (tempY - (100+29))+'px';
        	jQuery(".content-popover").show(); 
					jQuery('#divRefContent').hide(); 
					jQuery('#divNoRefContent').hide();
					jQuery('#divRefInterview').hide();
                    jQuery('#divCustomRefContent').hide();
					var summary = '{!JSENCODE(invitationcontroller.internalSummary)}';
					jQuery('#divSumm').css('display','block');
					 
					if ({!invitationcontroller.hoverContentVersion.Id != null}) {

                    	if ('{!invitationcontroller.hoverContentVersion.FileType}' == 'LINK') {
							jQuery(".content-popover").hide(); 
                            jQuery( "#divRefContent").dialog({
                                modal: true,
                                resizable: false,
                                draggable: false,
                                width : 700,
                                buttons: [{
                                    text: "{!$Label.Open}",
                                    "class": "dialogButtonClass",
                                    "style": "font-size:10.8px;cursor:pointer;text-align: center",
                                    click: function() {
                                        jQuery( this ).dialog( "close" );
                                        openContent('{!invitationcontroller.hoverRefContentId}', '{!invitationcontroller.hoverContentVersion.ContentUrl}', '{!invitationcontroller.hoverContentVersion.FileType}',false);
                                        return false;
                                    }
                                },{
                                    text: "{!$Label.View_Details}",
                                    "class": "dialogButtonClass",
                                    "style": "font-size:10.8px;cursor:pointer;text-align: center",
                                    click: function() {
                                        jQuery( this ).dialog( "close" );
                                        openContent('{!invitationcontroller.hoverRefContentId}', '{!invitationcontroller.hoverContentVersion.ContentUrl}', '{!invitationcontroller.hoverContentVersion.FileType}',true);
                                        return false;
                                    }
                                }]
                            });
						} else {
							jQuery(".content-popover").hide(); 
                            jQuery( "#divRefContent").dialog({
                                modal: true,
                                resizable: false,
                                draggable: false,
                                width : 700,
                                buttons: [{
                                    text: "{!$Label.Download}",
                                    "class": "dialogButtonClass",
                                    "style": "font-size:10.8px;cursor:pointer;text-align: center",
                                    click: function() {
                                        jQuery( this ).dialog( "close" );
                                        downloadSingleContent();
                                        return false;
                                    }
                                },{
                                    text: "{!$Label.View_Details}",
                                    "class": "dialogButtonClass", 
                                    "style": "font-size:10.8px;cursor:pointer;text-align: center",
                                    click: function() {
                                        jQuery( this ).dialog( "close" );
                                        openContent('{!invitationcontroller.hoverRefContentId}', '{!invitationcontroller.hoverContentVersion.ContentUrl}', '{!invitationcontroller.hoverContentVersion.FileType}',true);
                                        return false;
                                    }
                                }]
                            });
						}
					} else if ({!invitationcontroller.hoverContentVersion.Id == null} && {!invitationcontroller.refInterview.size == 0} && !{!invitationcontroller.customRefContent}) {  
						jQuery('#divNoRefContent').show();
						jQuery('.my-popover').css('max-height','100');					
					} else if ({!invitationcontroller.refInterview.size} > 0) {
                        jQuery('#divRefInterview').show();
						jQuery('.my-popover').css('max-height','350');
						jQuery('.my-popover').css('width','450');
						jQuery('.my-popover').css('max-width','450');
						jQuery("#btnView").show();
					} else if ({!invitationcontroller.customRefContent}) {
                        jQuery(".content-popover").hide(); 
                        jQuery( "#dialogBoxDivCustom").dialog({
                            modal: true,
                            resizable: false,
                            draggable: false,
                            width : 700,
                            height : 500,
                            buttons: [{
                                text: "{!$Label.View_Details}",
                                "class": "dialogButtonClass",
                                "style": "font-size:10.8px;cursor:pointer;text-align: center",
                                click: function() {
                                    jQuery( this ).dialog( "close" );
                                    openContent('{!JSENCODE(invitationcontroller.hoverRefContentId)}', '{!JSENCODE(invitationcontroller.hoverContentVersion.ContentUrl)}', '{!JSENCODE(contentSearch.hoverContentVersion.FileType)}',true);
                                    return false;
                                }
                            }]
                        });
                    }
					
				}
                function onHoverToLink() {            
                    var locationVar = jQuery('#helpmessageId');             
                    jQuery("#helpAndTraining").css({top: locationVar.offset().top + 30 - globalHeaderHeight, left: locationVar.offset().left - 92, position:'absolute'});
                    jQuery(".helpTraining").show();
                }
			</script>
		</apex:outputPanel> 
    
    <apex:form id="frmId" rendered="{!isFullLicenseAccessible}">  
      <apex:outputPanel rendered="{!!invitationcontroller.isSubmitted}">
        <div id="helpmessageId" style="cursor: pointer; float:right" onmouseover="onHoverToLink()">
            <span class="helpLink">{!$label.Help_for_this_page}</span>
            <img src="/img/s.gif" alt="" class="helpIcon" title=""/>
        </div>
       </apex:outputPanel>
       <!-- <apex:sectionHeader subtitle="{!$Label.New_Invitation}" title="{!$Label.Invitation_Edit}" help="RfSearchHelpPage?toshow=invitation" />-->
        <div align="left">   
            <apex:commandLink style="color:#5C95C4;" value="{!$Label.Back_to_RF_Search}" action="{!invitationToSearch}" id="backCmdLinkId" rendered="{!!invitationcontroller.isSubmitted}"/>
        </div>
        <c:RewardNotification /> 
        <!-- Page Block -->
        <apex:actionFunction name="fetchContentItem"  action="{!invitationcontroller.fetchHoverContentItem}" reRender="pgmsgId, dvContentDetails,loadContent,notificationPanel" oncomplete="showDivOncompleteAction();">
            <apex:param name="contId" value="" assignTo="{!invitationcontroller.hoverContentId}"/>
            <apex:param name="refContId" value="" assignTo="{!invitationcontroller.hoverRefContentId}"/>
        </apex:actionFunction>
        <apex:actionFunction name="downloadSingleContent" reRender="pgmsgId" action="{!invitationcontroller.singleContentDownload}" />
        <apex:actionFunction name="jsMicrosite" rerender="pbsId3" oncomplete="PORHideLoading();"/>
        <apex:actionFunction name="jsShowCoworkers" action="{!invitationcontroller.showCoworkers}" rerender="coworkersLinkPanel, opCoworkerId, lblCoWorkers" />
        <apex:actionFunction name="jsSetDefaultTemplate" action="{!invitationcontroller.setDefaultTemplate}" rerender="pgmsgId"/>
        <apex:actionFunction name="previewEmailJs" immediate="false" action="{!invitationcontroller.previewEmail}" rerender="jsPanel" oncomplete="previewEmail();"/>
        <apex:actionFunction name="jsSetContactEmailIds" rerender="pgmsgId" oncomplete="PORHideLoading();">
            <apex:param name="contactEmailIds" assignTo="{!invitationcontroller.contactEmailIds}" value=""/>
             <apex:param name="contactIds" assignTo="{!invitationcontroller.contactIds}" value=""/>
        </apex:actionFunction>
        <apex:actionFunction name="jsSetCoworkerEmailIds" rerender="pgmsgId" oncomplete="PORHideLoading();">
            <apex:param name="coworkerEmailIds" assignTo="{!invitationcontroller.coworkerEmailIds}" value=""/>
            <apex:param name="coworkerIds" assignTo="{!invitationcontroller.coworkerIds}" value=""/>
        </apex:actionFunction>
        <apex:actionFunction name="jsDoneAction" action="{!invitationcontroller.createInvitation}" rerender="pgmsgId,frmId" oncomplete="PORHideLoading();showDisolvingAlert();"/>
        
        <apex:actionFunction name="showRefContents" action="{!invitationcontroller.showRefContents}" rerender="pgmsgId,opSelectedRefContents" oncomplete="PORHideLoading();"/>
        <apex:actionFunction name="jsRemoveContent" action="{!invitationcontroller.removeContent}" oncomplete="PORHideLoading();" reRender="pgmsgId,opSelectedRefContents,micrositePanelId" >
            <apex:param name="contentToRemove" value="" assignTo="{!invitationcontroller.contentIdToRemove}" />
        </apex:actionFunction>
        <apex:outputPanel id="mainBlockId">
            <!-- Page Block -->
            <apex:pageBlock id="submittedId"  rendered="{!invitationcontroller.isSubmitted}">  
            	<apex:inputHidden value="{!invitationcontroller.rewardPoints}" id="rewardPoints"/>
            	<apex:inputHidden value="{!invitationcontroller.actionMessage}" id="actionMessage"/>
                <apex:pageMessage summary="{!$Label.Invitation_sent}" severity="INFO" strength="3" /> 
                <apex:commandButton value="{!$Label.Back_to_Opportunity}" action="{!invitationcontroller.returnOpportunity}" rendered="{!NOT(ISBLANK(invitationcontroller.opportunityId))}"/>
                <apex:commandButton value="{!$Label.Back_to_Case}" action="{!invitationcontroller.returnOpportunity}" rendered="{!NOT(ISBLANK(invitationcontroller.caseId))}"/>  
                <apex:commandButton value="{!$Label.Back_to_RF_Search}" action="{!invitationcontroller.returnOpportunity}" rendered="{!AND(ISBLANK(invitationcontroller.opportunityId),ISBLANK(invitationcontroller.caseId),ISBLANK(invitationcontroller.leadId))}"/>
                <apex:commandButton value="{!$Label.Back_to_SearchLead}" action="{!invitationcontroller.returnOpportunity}" rendered="{!NOT(ISBLANK(invitationcontroller.leadId))}"/>
                
            </apex:pageBlock>
            
            <!-- Page Block -->
            <apex:pageBlock id="pbId" mode="edit"  rendered="{!NOT(invitationcontroller.isSubmitted)}">
                <!-- Page Block Section 1-->
                <apex:pageBlockSection id="pbsId2" columns="1">
                    <apex:pageBlockSectionitem id="pbsConItemId">
                        <apex:outputLabel value="{!$Label.To_Contacts}"/>
                        <apex:outputPanel id="opContactsId">
                            <apex:actionRegion >
                                <div style="float:left">
                                <apex:inputTextarea disabled="true" id="txtContacts" style="margin-left:0px;width:500px;" value="{!invitationcontroller.contactEmailIds}"/>&nbsp;&nbsp;
                                </div>
                                <div id="imglookup" style="float:left">
                                <apex:image url="{!$Resource.lookupIconImage}" height="16px" width="16px" style="cursor:pointer;" onclick="return ShowLookup('{!$Page.InvitationContactsLookup}');" title="{!$Label.Contacts_Lookup_New_Window}"/>
                                </div>
                            </apex:actionRegion>
                        </apex:outputPanel>
                    </apex:pageBlockSectionitem>
                    <apex:pageBlockSectionitem id="pbsCoworkerItemId" >
                        <apex:outputPanel id="lblCoWorkers" >
                            <apex:outputLabel value="{!$Label.To_Co_workers}" />
                        </apex:outputPanel>
                        <apex:outputPanel id="opCoworkerId" >
                            <apex:actionRegion >
                                <div style="float:left">
                                    <apex:inputTextarea disabled="true" id="txtCoworker" style="margin-left:0px;width:500px;" value="{!invitationcontroller.coworkerEmailIds}"/>&nbsp;&nbsp;
                                </div>
                                <div style="float:left">
                                    <apex:image url="{!$Resource.lookupIconImage}" height="16px" width="16px" style="cursor:pointer;" onclick="return ShowLookup('{!$Page.InvitationCoworkersLookup}');" title="{!$Label.Co_workers_Lookup_New_Window}"/>
                                </div>
                            </apex:actionRegion> 
                        </apex:outputPanel>
                    </apex:pageBlockSectionitem>
                    <apex:pageBlockSectionItem >    
                        <apex:outputLabel value="{!$Label.Subject}"/>
                        <apex:outputPanel >
                            <div class="requiredInput">
                            <div class="requiredBlock"></div>
                                <apex:inputField value="{!invitationcontroller.invitation.Subject__c}" id="subId" style="width:500px;"/>
                            </div>
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    
                    <apex:pageBlockSectionitem id="pbsMsgItemId">
                        <apex:outputLabel value="{!$Label.Message}"/>
                        <apex:outputPanel >
                            <div style="float:left">
                                <apex:inputField value="{!invitationcontroller.invitation.Message__c}" id="messageId" style="width:500px;"/> 
                            </div>
                            
                            <div style="float:left;margin-left : 3px;">
                                <apex:commandLink style="color:#5C95C4;" value="{!$Label.Preview_E_mail}" onclick="return jsAction();"/>
                            </div>
                        </apex:outputPanel>
                    </apex:pageBlockSectionitem>
                </apex:pageBlockSection>
                
                <!-- Page Block Section 2-->
                <apex:pageBlockSection id="pbsId1" columns="1" title="{!$Label.Invitation_Settings}">
                    <apex:inputField label="{!$Label.Invitation_Name}" value="{!invitationcontroller.invitation.Name}" id="nameId" style="width:20%">
                        <span id="invSetting">&nbsp;</span>
                    </apex:inputField>
                    <apex:pageBlockSectionitem id="pbsInvExpItemId" >
                        <apex:outputLabel value="{!$Label.Invitation_Expiration}" />
                        <apex:outputPanel styleClass="requiredInput" layout="block">
                            <div class="requiredBlock"></div>
                            <apex:inputField label="{!$Label.Invitation_Expiration}" value="{!invitationcontroller.invitation.Invitation_Expiration__c}" id="expId"/>
                            <B><apex:outputLabel value="(max {!TEXT(invitationcontroller.maximumExpirationDays)} days)" /></B>
                        </apex:outputPanel>
                    </apex:pageBlockSectionitem>
                    
                    <apex:outputField value="{!invitationcontroller.invitation.Opportunity__c}" id="oppId" rendered="{!NOT(ISNULL(invitationcontroller.invitation.Opportunity__c))}"/>
                    <apex:inputField label="{!$Label.Notes}" value="{!invitationcontroller.invitation.Notes__c}" id="noteId" style="width:20%"/>
                </apex:pageBlockSection>    
                <!-- Page Block Section 3-->
                <apex:pageBlockSection id="pbsId3" columns="1" title="{!$Label.Microsite}">
                    <apex:pageBlockSectionItem id="pbsCTId">    
                        <apex:outputLabel value="{!$Label.Current_Template}"/>
                        <apex:outputPanel >
                            <div id="divReq" class="requiredInput">
                            <div class="requiredBlock"></div>
                                <apex:selectList size="1" label="{!$Label.Current_Template}" value="{!invitationcontroller.invitation.Microsite__c}" onchange="PORShowLoading();jsMicrosite();return false;" id="microSiteId">
                                    <apex:selectOptions value="{!invitationcontroller.microsites}"/>
                                </apex:selectList>
                                <apex:commandLink id="defaultTemplateId" style="color:#5C95C4;" value="{!$Label.Save_as_my_default_template}" onclick="checkTemplate(); return false;"/>
                            </div>
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    
                    <apex:pageBlockSectionitem id="pbsItemId" >
                        <apex:outputLabel value="{!$Label.Microsite}" />
                        <apex:commandLink value="{!$Label.Preview_Microsite}" onclick="previewMicrosite(); return false;"/>
                    </apex:pageBlockSectionitem>
                    <apex:pageBlockSectionitem id="invcontentsId" >
                        <apex:outputLabel value="{!$Label.Invitation_Contents}" />
                        <apex:outputPanel >
                            <apex:commandLink value="{!$Label.Manage}" onclick="PORShowLoading();jsShowRefContents(); return false;"/>&nbsp;&nbsp;
                            <apex:commandLink value="{!$Label.Add_Content}" action="{!invitationToSearch}" id="addContentId"/>
                        </apex:outputPanel>
                    </apex:pageBlockSectionitem>
                    <apex:outputPanel id="opSelectedRefContents"> 
                    <script>
                        isContentHide = '{!invitationcontroller.isRefcontentBlock}';
                    </script>
                        <apex:pageBlockSection collapsible="false" id="pbstableId" columns="1" title="{!$Label.Included_Reference_Content}" rendered="{!AND(invitationcontroller.isRefcontentBlock, invitationcontroller.listReferenceContent.size > 0)}">
                            <div id="divContnet"></div>
                            <apex:pageBlockTable value="{!invitationcontroller.listReferenceContent}" var="cw" id="pbtContent" >
                                <apex:column headerValue="{!$Label.Action}" >
                                    <apex:commandLink style="color:#5C95C4;" value="{!$Label.Delete}" onclick="PORShowLoading();jsRemoveContent('{!JSENCODE(cw.refContent.id)}'); return false;"/>
                                </apex:column>
                                <apex:column >  
                                    <apex:outputPanel rendered="{!NOT(cw.refContent.Custom_Reference_Content__c)}">
                                        <img src="{!URLFOR($Resource.LightningCSS, cw.fileTypeImagePath)}" onclick="showDiv('{!JSENCODE(cw.refContent.Content_ID__c)}', '{!JSENCODE(cw.refContent.Id)}', event,'Content_{!cw.refContent.Id}');" url="{!URLFOR($Resource.ExtensionImages, cw.fileTypeImagePath)}" rel="content-popup-ui" id="Content_{!cw.refContent.Id}"  alt="Tags" height="30" width="25" style="cursor:pointer;" /> 
                                    </apex:outputPanel>
                                    <apex:outputPanel rendered="{!cw.refContent.Custom_Reference_Content__c}">
                                        <img src="{!URLFOR($Resource.refEdgeCutomContent)}" onclick="showDiv('{!JSENCODE(cw.refContent.Content_ID__c)}', '{!JSENCODE(cw.refContent.Id)}', event,'Content_{!cw.refContent.Id}');" url="{!URLFOR($Resource.refEdgeCutomContent)}" rel="content-popup-ui" id="Content_{!cw.refContent.Id}"  alt="Tags" height="30" width="25" style="cursor:pointer;" /> 
                                    </apex:outputPanel>
                                </apex:column> 
                                <apex:column headerValue="{!$Label.Title}" style="min-width:200px;">
                                    <apex:outputText value="{!cw.refContent.Title__c}"/> 
                                </apex:column>
                                
                                <apex:column headerValue="{!$Label.Type}" value="{!cw.refContent.Reference_Content_Type__r.Name__c}"/> 
                                
                                <apex:column headervalue="{!$Label.Account}">
                                    <apex:outputLink value="{!cw.accountIds}" id="accName" target="_blank">
                                        <apex:outputText value="{!cw.accountName}"/>
                                    </apex:outputLink>
                                </apex:column>
                            </apex:pageBlockTable>
                        </apex:pageBlockSection>
                    </apex:outputPanel>
                </apex:pageBlockSection>
                
                <!-- Page Block Buttons-->
                <apex:pageBlockButtons id="pbbId">
                    <div id="dvButton">
                        <apex:commandButton value="{!$Label.Send}" onclick="PORShowLoading();assignParameters();return false" id="doneId"/>
                        <apex:commandButton value="{!$Label.Cancel}" action="{!backToSearchFromInvitation}" id="cancelId"/>
                    </div>
                </apex:pageBlockButtons>
             
                <apex:outputPanel id="jsPanel">
                    <script>
                        var msg = '{!JSENCODE(invitationcontroller.message)}';
                        var date = '{!JSENCODE(invitationcontroller.datetext)}';
                        function previewEmail() {
                            var temp = jQuery("#emailPreviewDiv").html().replace(previousMsg,msg);
                            temp = temp.replace(previousDate,date);
                            jQuery("#emailPreviewDiv").html(temp);
                            jQuery("#emailPreviewDiv").dialog({
                                height    : 600,
                                width     : 800,
                                modal     : true,
                                resizable : false,  
                            });
                            previousMsg = msg;
                            previousDate = date;
                        }
                    </script>
                </apex:outputPanel>
            </apex:pageblock>
        </apex:outputPanel>
        
        <apex:outputPanel id="emailPreviewDivId">
            <div id="emailPreviewDiv" title="{!$Label.E_mail_Preview}" style="display:none;white-space: pre;">
                <apex:outputText value="{!invitationcontroller.templateBody}" escape="false"/>
            </div>
        </apex:outputPanel>

        <apex:outputPanel id="notificationPanel">
            <div id="dialogBoxDivCustom" title="{!invitationcontroller.referenceContentTitle}" style="display:none;min-height: 150px!important;max-height: 500px!important;">  
                <div style="overflow :hidden;">
                    <apex:repeat value="{!invitationcontroller.refContentFields}" var="rcf"> 
                        <apex:repeat value="{!invitationcontroller.customContentTypeFields}" var="fieldAPIName"> 
                        <p style="margin-block-end: 0.5em;font-weight: bold;margin-top:7px !important;">{!invitationcontroller.mapCustomContentLabels[fieldAPIName].label}</p>
                        <apex:outputPanel rendered="{!invitationcontroller.mapCustomContentLabels[fieldAPIName].type != 'BOOLEAN' && invitationcontroller.mapCustomContentLabels[fieldAPIName].type != 'DATETIME' && invitationcontroller.mapCustomContentLabels[fieldAPIName].type != 'DATE'}">
                            <label style="max-height:1000px;overflow-y:hidden;font-weight:normal;">{!rcf[fieldAPIName]}</label> 
                        </apex:outputPanel>
                        <apex:outputPanel rendered="{!invitationcontroller.mapCustomContentLabels[fieldAPIName].type == 'BOOLEAN'}">
                            <apex:inputcheckbox value="{!rcf[fieldAPIName]}" disabled="true"/>
                        </apex:outputPanel>
                        <apex:outputPanel rendered="{!invitationcontroller.mapCustomContentLabels[fieldAPIName].type == 'DATETIME' || invitationcontroller.mapCustomContentLabels[fieldAPIName].type == 'DATE'}">
                            <apex:outputText value="{0,date,MMM dd yyyy}"> 
                                <apex:param value="{!rcf[fieldAPIName]}" /> 
                            </apex:outputText>
                        </apex:outputPanel>
                        </apex:repeat>    
                    </apex:repeat>   
                    <p style="font-weight: bold;">{!$Label.Summary}</p>
                    <p style="max-height:1000px;overflow-y: HIDDEN !important;">{!invitationcontroller.internalSummary}</p>    
                </div>
            </div>
            <div id="divRefContent" title="{!invitationcontroller.hoverContentVersion.Title}" style="display:none;min-height: 100px!important;max-height: 500px!important;">
                <div  class="description-text"> 
                    <div style="max-height:100%;overflow-y: scroll;">
                        <label style="font-weight: bold;">{!$Label.Type}</label> 
                        <p style="margin-block-start: 0.5em;"> {!invitationcontroller.hoverContentVersion.FileType} </p>
                        <label  style="font-weight: bold;margin-top:8px;">{!$Label.SIZE}</label>
                        <p style="margin-block-start: 0.5em;"> {!invitationcontroller.hoverContentVersion.ContentSize} </p>
                        <div  id="divSumm" >
                            <label style="font-weight: bold;">{!$Label.Summary}</label>
                            <div>  
                                <p style="margin-block-start: 0.5em;max-height: unset!important;overflow-y: unset!important;"  id="sSumm">{!invitationcontroller.internalSummary}</p>
                            </div>
                        </div>
                    </div>
                </div> 
            </div> 
        </apex:outputPanel>
        
        <!-- Div for on Mouse hover -->
        <apex:outputPanel style="display:none;width:380px;position:absolute;z-index:1000;scroll-y:auto;" id="dvContentDetails">
	        <div id="divContentPopupover" rel="content-popup-ui" class="content-popover my-popover arrow_box"  style ="overflow: hidden;">
	                        <h1 rel="content-popup-ui"><span rel="content-popup-ui"  id = "sContentAccountName"></span></h1><input value="X" onclick="PopoverHide();" type="button"/>
	                        <div rel="content-popup-ui" class="description-text"> 
	                            <!-- Reference Contents  
	                            <div id="divRefContent">
	                            	<h1 rel="content-popup-ui" style="line-height: 16px;"><span rel="content-popup-ui" id = "sContent">{!invitationcontroller.hoverContentVersion.Title}</span></h1> 
									<div rel="content-popup-ui" class="description-text"> 
										<div style="max-height:180px;overflow-y: scroll;">
                                            <p rel="content-popup-ui">{!$Label.Type} <i> {!invitationcontroller.hoverContentVersion.FileType} </i></p> 
                                            <p rel="content-popup-ui" style="margin-top:8px;">{!$Label.SIZE} <i> {!invitationcontroller.hoverContentVersion.ContentSize} </i></p>
                                            
                                            <div rel="content-popup-ui" id="divSumm" >
                                                <p rel="content-popup-ui">{!$Label.Summary}</p>
                                                <div style="overflow-y :hidden; overflow-x :hidden;">  
                                                    <label style="max-height: unset!important;overflow-y: unset!important;" rel="content-popup-ui" id="sSumm">{!invitationcontroller.hoverContentVersion.Description}</label>
                                                </div>
                                            </div>
                                        </div>
										<div style="text-align: center;margin-right:15px;margin-top:15px;">
											<button type="button" rel="content-popup-ui" id="btnOpen" style="font-size:10.8px;cursor:pointer;" onclick="openContent('{!invitationcontroller.hoverRefContentId}', '{!invitationcontroller.hoverContentVersion.ContentUrl}', '{!invitationcontroller.hoverContentVersion.FileType}',false); return false;" >{!$Label.Open}</button>
											<button type="button" rel="content-popup-ui" id="btnDownload" style="font-size:10.8px;cursor:pointer;" onclick="downloadSingleContent(); return false;">{!$Label.Download}</button>
											<button type="button" rel="content-popup-ui" id="btnView" style="font-size:10.8px;cursor:pointer;" onclick="openContent('{!invitationcontroller.hoverRefContentId}', '{!invitationcontroller.hoverContentVersion.ContentUrl}', '{!invitationcontroller.hoverContentVersion.FileType}',true); return false;" >{!$Label.View_Details}</button>
										</div>
									</div> 
	                            </div>  -->
	                            
	                            <!-- No Custom Reference Contents -->
	                            <div id ="divNoRefContent"> 
	                                <div rel="content-popup-ui" ><span rel="content-popup-ui" >{!$Label.Content_View_Permission_Message}</span></div>  
	                            </div> 
                                <!-- Custom Reference Contents
                                    <div id="divCustomRefContent" rel="content-popup-ui" rendered="{!invitationcontroller.customRefContent}">  
                                        <div rel="content-popup-ui"  style="width:300px ;float:left; font-family: sans-serif; letter-spacing: 0.0611em;color: #445FB8;"><span rel="content-popup-ui" id = "sContent">{!invitationcontroller.referenceContentTitle}</span></div> 
                                        <div rel="content-popup-ui" style="width:325px;overflow-x :hidden;max-height:180px"> 
                                            <apex:repeat value="{!invitationcontroller.refContentFields}" var="rcf"> 
                                                <apex:repeat value="{!invitationcontroller.customContentTypeFields}" var="fieldAPIName"> 
                                                    <p rel="content-popup-ui" style="margin-top:7px !important;">{!invitationcontroller.mapCustomContentLabels[fieldAPIName].label}</p>
                                                    <apex:outputPanel rendered="{!invitationcontroller.mapCustomContentLabels[fieldAPIName].type != 'BOOLEAN' && invitationcontroller.mapCustomContentLabels[fieldAPIName].type != 'DATETIME' && invitationcontroller.mapCustomContentLabels[fieldAPIName].type != 'DATE'}">
                                                        <label rel="content-popup-ui" class=".description-text-all"  style="max-height:1000px;overflow-y:hidden;font-weight:normal;">{!rcf[fieldAPIName]}</label> 
                                                    </apex:outputPanel>
                                                    <apex:outputPanel rendered="{!invitationcontroller.mapCustomContentLabels[fieldAPIName].type == 'BOOLEAN'}">
                                                        <apex:inputcheckbox value="{!rcf[fieldAPIName]}" disabled="true"/>
                                                    </apex:outputPanel>
                                                    <apex:outputPanel rendered="{!invitationcontroller.mapCustomContentLabels[fieldAPIName].type == 'DATETIME' || invitationcontroller.mapCustomContentLabels[fieldAPIName].type == 'DATE'}">
                                                        <apex:outputText value="{0,date,MMM dd yyyy}">
                                                            <apex:param value="{!rcf[fieldAPIName]}" /> 
                                                        </apex:outputText>
                                                    </apex:outputPanel>
                                                </apex:repeat>  
                                            </apex:repeat>   
                                            <p rel="content-popup-ui">{!$Label.Summary}</p>
                                            <label rel="content-popup-ui" class=".description-text-all" style="max-height:1000px;overflow-y: HIDDEN !important;">{!invitationcontroller.internalSummary}</label>    
                                                  
                                        </div>
                                        <div rel="content-popup-ui" style="text-align: center;margin-top:15px;"> 
                                            <button type="button" rel="content-popup-ui" id="btnView" style="font-size:10.8px;cursor:pointer;" onclick="openContent('{!JSENCODE(invitationcontroller.hoverRefContentId)}', '{!JSENCODE(invitationcontroller.hoverContentVersion.ContentUrl)}', '{!JSENCODE(contentSearch.hoverContentVersion.FileType)}',true); return false;" >{!$Label.View_Details}</button>
                                        </div>
                                    </div> -->
	                            <!-- Interview Type Content Reference -->
	                            <div id="divRefInterview" rel="content-popup-ui" >
	                                <apex:outputPanel rendered="{!invitationcontroller.refInterview.size >0}" layout="block" style="width:100%;background-color:white;">
	                                    <div class="panel-group" id="accordion" style="width:100%;float:left;background:#F4F6F9;max-height:300px !important;overflow-y:auto;">
	                                        <div class="panel panel-default" style="float:right;width:100%;border:1px solid #F4F6F9;margin-top: -1px;background-color:#F4F6F9;">
	                                            <div id="contentDetails" rel="content-popup-ui"  class="imageDiv" style="background-color: #F4F6F9;border:0px solid gray;border-radius:0px;width:100%;height:100%;">
	                                                <div rel="content-popup-ui"  style="width:290px ;float:left">
	                                                    <apex:outputPanel layout="block" >
	                                                        <div id="imagePanel" rel="content-popup-ui" styleClass="imagePanelClass" style="width:100%;float:left;text-align:left;padding-left: 10px;">
	                                                            <div rel="content-popup-ui" ></div>
	                                                            <apex:outputField styleclass="ImageClass" style="display: table !important;" id="imageIds" value="{!invitationcontroller.refInterviewRecord.Photograph__c}" />
	                                                        </div>
	                                                        <div rel="content-popup-ui"  style="width:100%;float:left;font-weight:bold;font-size:14px;padding-top: 2%;">
	                                                            <div rel="content-popup-ui" ></div>
	                                                            <span rel="content-popup-ui" id = "sContent">{!invitationcontroller.refInterviewRecord.Reference_Content__r.Title__c}</span>
	                                                        </div>
	                                                    </apex:outputPanel>
	                                                    <div rel="content-popup-ui" style="width:100%;float:left;padding-left:10px;">
	                                                        <div rel="content-popup-ui" style="float:left;width:100%;">
	                                                            <a data-toggle="collapse" data-parent="#accordion" style="float:left;width:90%;" rel="content-popup-ui" href="#collapseTrnanscrptInfo"> 
	                                                                <span rel="content-popup-ui" style="font-weight:bold;cursor:pointer;margin-left:3px;">{!$Label.Reference_Interview_Info}</span> 
	                                                            </a>
	                                                        </div>
	                                                        <div id="collapseTrnanscrptInfo" rel="content-popup-ui"  style="float:left;width:90%;" class="panel-collapse collapse">
	                                                            <span rel="content-popup-ui"  style="font-weight:bold;font-family: Arial,Helvetica,sans-serif; color: #222;">{!$ObjectType.Reference_Interview__c.fields.Speaker_info__c.label}</span> 
	                                                            <span rel="content-popup-ui">{!invitationcontroller.refInterviewRecord.Speaker_info__c}</span> 
	                                                            
	                                                            <br/>
	                                                            <span rel="content-popup-ui"  style="font-weight:bold;font-family: Arial,Helvetica,sans-serif; color: #222;">{!$ObjectType.Reference_Interview__c.fields.Org_website__c.label}</span>&nbsp;
	                                                            <apex:commandLink style="color:blue" value="{!invitationcontroller.refInterviewRecord.Org_website__c}" onClick="openSite('{!invitationcontroller.refInterviewRecord.Org_website__c}');return false;" />
	                                                            <br/>
	                                                            <span rel="content-popup-ui"  style="font-weight:bold;font-family: Arial,Helvetica,sans-serif; color: #222;">{!$ObjectType.Reference_Interview__c.fields.Org_description__c.label}</span>&nbsp;
	                                                            <apex:outputField value="{!invitationcontroller.refInterviewRecord.Org_description__c}" />
	                                                        </div>
	                                                    </div>
	                                                    <table style="width:100%;float:left;margin-top:1%;">
	                                                        <tbody style="width:100%;">
	                                                            <apex:repeat value="{!invitationcontroller.refInterviewRecord.Interview_Topics__r}" var="interviewTopic">
	                                                                <tr style="width:100%;">
	                                                                    <td style="width:100%;border: 1px solid #F4F6F9;">
	                                                                        <div rel="content-popup-ui" style="float:left;width:95%;padding-left: 10px;">
	                                                                            <a data-toggle="collapse" data-parent="#accordion" style="float:left;width:100%;" rel="content-popup-ui" href="#collapseTrnanscrpt{!interviewTopic.id}">
	                                                                                <span  rel="content-popup-ui"  style="font-weight:bold;cursor:pointer;" >{!interviewTopic.Question__c}</span>
	                                                                            </a>
	                                                                        </div>
	                                                                        <div id="collapseTrnanscrpt{!interviewTopic.id}" rel="content-popup-ui" style="float:left;width:99%;" class="panel-collapse collapse in">
	                                                                            <!--<apex:outputPanel rendered="{!interviewTopic.Video_Url_Embed__c != null}"> -->
	                                                                            <div rel="content-popup-ui">
	                                                                                <iframe id="player" width="300" height="205" src="{!interviewTopic.Video_Url_Embed__c}?showinfo=0&rel=0&modestbranding=1"/>
	                                                                                <script src="https://www.youtube.com/iframe_api"></script>
	                                                                             </div> 
	 																		    <!--</apex:outputPanel> -->
																				<apex:outputLabel style="font-weight:normal;padding-left: 10px;" value="{!interviewTopic.Transcript__c}" />
	                                                                         </div>
																		</td>
																	</tr>
																</apex:repeat>
															</tbody>
														</table>
													</div>                  
												</div>
											</div>
										</div>
									</apex:outputPanel>
								</div>
							</div> 
				   </div>   
        </apex:outputPanel>
    </apex:form> 
    <!--   
       
        objective : To show HelpOverlays
        modified By : Rajesh
         -->

    <div id="helpAndTraining" rel="helpTraining_popup" class="helpTraining arrowHelpTraining">
        <div class ="header">
            {!$Label.Help_and_trainning}
        </div>
        <div class="tour" onclick="rfSearchTour()" style="cursor: pointer; padding-left: 10px;padding-bottom: 15px;">
            <div style="float:left"><apex:image value="{!URLFOR($Resource.helpOverlayIcon,'/myIcons/plybtn3.png')}" style="width : 24px; height : 21px;"/>&nbsp;&nbsp;</div><div style="padding-top:6px">
                {!$Label.Invitation_Search_Tour}
            </div>
        </div>
        <div class="help" onclick="rfSearchHelp()" style="cursor: pointer; padding-bottom: 23px;">
            <div style="float:left"><apex:image value="{!URLFOR($Resource.helpOverlayIcon,'/myIcons/bookIcon.png')}" style="width : 30px; height : 30px;"/>&nbsp;&nbsp;</div><div style="padding-top:6px">
                {!$Label.Invitation_Search_Help}
            </div>            
        </div>
    </div>
     <!--   To show / Hide walkThrough for the page    -->  
        <c:HelpOverlays />  
    <!--  To show / Hide walkThrough for the page    ---   END     --- --> 
    <style>
        .textStyle{
            font-family: arial,sans-serif;
            font-size: 120%;
        }
        .overlay {
            position: relative;
            border-radius: .25rem;
            width: 22rem !important;
            min-height: 2rem;
            z-index: 6000;
            border-color: rgb(6, 28, 63);
            display: none;
            box-shadow: 0 2px 3px 0 rgba(0, 0, 0, 0.16);
            font-family: 'Salesforce Sans',Arial,sans-serif;
            line-height: 1.5;
            background: rgba(176, 196, 223, 1.0);
            color: rgb(62, 62, 60);
            font-size: 13px;
        }
         .overlay_Header-cls {
            background-color: rgb(33, 67, 112);
            padding: 1rem !important;
            text-shadow: 0 0 4px rgb(3, 46, 97);
            color: white;
            height: 13px !important;
            border-top-right-radius: 3px !important;
            border-top-left-radius: 3px !important;
            font-family: 'Salesforce Sans',Arial,sans-serif;
            font-size: 15px;
        }

        .overlay_body-cls { 
            min-height: 10vh; 
            padding-top:3px;
        }

        .btn-next { 
            width: 32px;
        }
    </style>
    
</apex:page>