<apex:component controller="GlobalController">
<!-- Start: unit deal -->
                    <div class="bp-accordion-entry expanded"  ng-class = "{'bp-collapse' : M_CO.expandedSectionName != 'Deal','disable-accordion' : !GroupOnlyPermissions['Deal']['view']}" >
                        <div class="bp-accordion-header bp-purple">
                            <div class="bp-accordion-toggle bp-purple-dark" ng-if = "M_CO.expandedSectionName != 'Deal'"
                                ng-click = "F_CO.expandOrCollapseSection('Deal_SectionId', 'Deal' ,'', GroupOnlyPermissions['Deal']['view'])">
                                <i ng-include="'{!Application_Images}/Icons/arrowDown.svg'" class="white_FFF_NewCO"></i>
                            </div>
                            <div class="bp-accordion-toggle bp-purple-dark" ng-if = "M_CO.expandedSectionName == 'Deal'" 
                                ng-click = "F_CO.expandOrCollapseSection('Deal_SectionId', 'Deal' ,'', GroupOnlyPermissions['Deal']['view'])">
                                <i  ng-include="'{!Application_Images}/Icons/arrowUp.svg'" class="white_FFF_NewCO"></i>
                            </div>
                            
                            <div class="bp-accordion-header-left" ng-click = "F_CO.expandOrCollapseSection('Deal_SectionId', 'Deal','', GroupOnlyPermissions['Deal']['view'],$event)">
                                <div class="bp-accordion-name">
                                    <i ng-include="'{!Application_Images}/Icons/Unit_V2.svg'" class="white_FFF_NewCO left-icon UnitDealIcon"></i>{{'Unit_deal' | translate}}
                                </div>
                              <div class="bp-accordian-right-content">
                                    <span class="total-calculation">{{'Label_Total' | translate}}: {{(F_CO.getDealTotal() ? F_CO.getDealTotal() : 0.00) | currency}}</span>
                                    <span class="customer-pay">{{M_CO.Deal.DealInfo.DealType}}</span>
                                    <div class="badge-container bp-cursor-pointer  showTopWorkStatue {{M_CO.changeDealStatusCssConfig[M_CO.Deal.DealInfo.DealStatus == 'Fulfilled' ? 'Approved' : M_CO.Deal.DealInfo.DealStatus]}}" 
                                        ng-click="F_CO.openChangeDealStatusConfig()"
                                         ng-class="{'bp-cursor-default': !F_CO.getSOPermissionType()['view'] }">
                                        <span class="text-capitalize">Status: </span>{{M_CO.Deal.DealInfo.DealStatus == 'Fulfilled' ? 'Approved' : M_CO.Deal.DealInfo.DealStatus}}
                                    </div>
                                    <div class="badge-container showClaimStatue bp-pointer-cursor {{M_CO.dealOptionsStatusCssConfig[M_CO.Deal.OptionStatus]}}" ng-click="F_CO.openConfirmationDialog('DealOptionStatus', true);">
                                        <span>Options: </span>{{F_CO.getDealOptionStatus(M_CO.Deal);}}
                                    </div>
                                </div>
                             </div>
                        </div>
                        <div class="bp-accordion-detail bp-collapse-div-transition" id="Deal_SectionId" ng-class="{'bp-expand-div-transition': M_CO.expandedSectionName == 'Deal'}">
                            <div> 
                                <!-- Start: inner Accordian level 1 -->
                                <!-- Start: Deal Summary accordian start here -->
                                <div class="bp-inner-accordian open bp-inner-accordian-deal" ng-class="{'bp-inner-accordian-opened': M_CO.expandedInnerSectionName == 'Deal_Details', 'bp-inner-accordian-opened-deal': M_CO.expandedInnerSectionName == 'Deal_Details'}">
                                    <div class="inner-accordian-header col-md-12"  ng-click = "F_CO.expandOrCollapseInnerSection('Deal_DetailsSectionId', 'Deal_Details')">
                                        <div class="inner-accordian-header-left">
                                            <h2 class="accordian-left-details">{{'Summary' | translate}}
                                            </h2>
                                            <a class="inner-accordian-subheader" ng-click="F_CO.goToDP360()" ng-if="M_CO.coHeaderRec.IsDP360SyncEnabled && M_CO.Deal.DealInfo.DealStatus != 'Invoiced' && M_CO.expandedInnerSectionName == 'Deal_Details'">GO TO DP360</a>
                                            <i ng-include="'{!Application_Images}/Icons/refresh.svg'" ng-if="M_CO.coHeaderRec.IsDP360SyncEnabled && M_CO.Deal.DealInfo.DealStatus != 'Invoiced' && M_CO.expandedInnerSectionName == 'Deal_Details'" ng-click = "F_CO.syncDealWithDP360()" class="bp-blue3384ff svg_width_2px inner-accordian-subheader-icon"></i>                                        
                                        </div>
                                       <div class="accordian-right-details">
                                            <a class="down-arrow-icon" ng-if = "M_CO.expandedInnerSectionName != 'Deal_Details'">
                                                <i ng-include="'{!Application_Images}/Icons/arrowDown.svg'" class="blue_008DC1"></i>
                                            </a>
                                            <a class="down-arrow-icon" ng-if = "M_CO.expandedInnerSectionName == 'Deal_Details'">
                                                <i ng-include="'{!Application_Images}/Icons/arrowUp.svg'" class="blue_008DC1"></i>
                                            </a>
                                            <div class="accordian-right-details-text">
                                                <p class="right-text required" ng-if="(M_CO.expandedInnerSectionName != 'Deal_Details' && M_CO.Deal.DealInfo.DealStatus == 'Quotation')">
                                                    <span></span> 
                                                    <span class="req-icon">!</span>
                                                </p>
                                           </div>
                                        </div>
                                    </div>
                                    <div class="inner-accordian-body bp-light-gray4 col-md-12 bp-collapse-div-transition"  id="Deal_DetailsSectionId"
                                        ng-class="{'bp-expand-div-transition': M_CO.expandedInnerSectionName == 'Deal_Details'}">
                                        <div class="expandableContainer">
                                           <div class = "col-xs-12 col-sm-6 form-container">
                                                <div class = "col-xs-12">
                                                    <label class = "col-xs-12 MB0 MT15">{{'Deal_status' | translate}}</label>
                                                    <div class="col-xs-12 P0">
                                                         <div class = "dealStaus">
                                                             <label class="badge-style col-xs-3 {{M_CO.changeDealStatusCssConfig[M_CO.Deal.DealInfo.DealStatus == 'Fulfilled' ? 'Approved' : M_CO.Deal.DealInfo.DealStatus]}}">{{M_CO.Deal.DealInfo.DealStatus == 'Fulfilled' ? 'Approved' : M_CO.Deal.DealInfo.DealStatus}}</label>
                                                             <span>
                                                                  <a ng-if="F_CO.getSOPermissionType()['create/modify']" ng-click="F_CO.openChangeDealStatusConfig()">{{'Change_deal_status' | translate}} </a> 
                                                             </span>
                                                         </div>
                                                          <div class="col-md-12 P0 bp-orange-dark-font dealStatusValue  required">
                                                           <span ng-if = "M_CO.Deal.DealInfo.DealStatus == 'Quotation'" class="req-icon">!</span>
                                                            <span class = "dealquation" ng-class = "{'bp-dark-grey2-font':M_CO.Deal.DealInfo.DealStatus != 'Quotation'}">{{M_CO.DealUnitStatusMap[M_CO.Deal.DealInfo.UnitStatus]}}</span> 
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <div class = "col-xs-12">
                                                    <label class = "col-xs-12 dealType">{{'Deal_type' | translate}}</label>
                                                    <div class="col-xs-12 P0">
                                                        <span class = "text-uppercase dealTypeValue bp-grey-font">{{M_CO.Deal.DealInfo.DealType}}</span>
                                                    </div>
                                                </div>
                                                
                                                <div class = "col-xs-12 dealQuotation"  ng-if = "M_CO.Deal.DealInfo.DealStatus != 'Fulfilled'">
                                                    <label class = "col-xs-12">{{'Delivery_date' | translate}}</label>
                                                    <div class="col-xs-12 P0">
                                                        <div class="bp-cell  searchInputArea makeSeachingWrapper">
                                                            <div class="datePickerWrappercontainer" >
                                                            <!-- <input type = "text" id="DeliveryDate" style="background: #FFF;position: initial;" class="bp-input-text  datePickerColor datepicker UnitOrderingMFDate"
                                                                ng-model = "M_CO.Deal.DealInfo.DeliveryDate"/> -->
                                                                <input type="text"  id="DeliveryDate" style="background: #FFF;position: initial;" ui-date="M_CO.deliveryDate" 
                                                                    ui-date-format="{{M_CO.dateFormat}}" 
																	ng-change="F_CO.Deal.saveDealInfo()"
                                                                    class="bp-input-text  datePickerColor datepicker UnitOrderingMFDate"
                                                                     ng-disabled = "!GroupOnlyPermissions['Deal']['create/modify'] || M_CO.Deal.DealInfo.DealStatus == 'Approved'"
                                                                    ng-model = "M_CO.Deal.DealInfo.DeliveryDate" placeholder="{{ 'Please_select' | translate }}" readonly="readonly"/>        
                                                                     <i ng-include="'{!Application_Images}/Icons/calendar-filled.svg'" class="UnitOrderingMFDateicon grey_DDDDDD"
                                                                        id="DeliveryDateBtn" ng-click = "M_CO.showCalander('DeliveryDate')">
                                                                    </i> 
                                                           </div>
                                                        </div>  
                                                    </div>
                                                </div>
                                                <div class = "col-xs-12 dealQuotation"  ng-if = "M_CO.Deal.DealInfo.DealStatus != 'Fulfilled'">
                                                    <label class = "col-xs-12">{{'Salesperson' | translate}}</label>
                                                    <div class="col-xs-12 P0">
                                                        <div class = "bp-autocomplete-Wrapper autocomplete_v2">
                                                            <span class = "bp-autocomplete-image-icon">
                                                                <i ng-include = "'{!Application_Images}/Icons/arrowDown.svg'" class="bp-blue bp-cursor-pointer svg_width_2px" ng-click = "F_CO.setFocusOnInput('DealSalesPerson')"></i>
                                                            </span>
                                                              <input  type="text" id="DealSalesPerson" class="bp-autocomplete-input border-radius-none bp-input-text bp-cursor-pointer manage-long-salesperson-person" placeholder="{{ 'Please_Select' | translate }}"
                                                                autocomplete="off"
                                                                ng-focus = "F_CO.Deal.getSalesPersonList();" ng-blur = "M_CO.showSalesPersonList = false;"
                                                                ng-model="M_CO.SalesPerson.TechnicianName"
                                                                ng-click = "F_CO.setFocusOnInput('DealSalesPerson')"
                                                                ng-disabled = "M_CO.Deal.DealInfo.DealStatus == 'Invoiced'"
                                                                ng-keyup="F_CO.Deal.keyBoardNavigation($event, M_CO.salesPersonList, 'DealSalesPerson' , M_CO.SalesPerson.TechnicianName);"
                                                                readonly="readonly"/>                       
                                                            <div class = "bp-autocomplete-dropdown-wrapper" ng-if="M_CO.showSalesPersonList" id = "DealSalesPersonDropDownDiv">
                                                                <ul>
                                                                     <li ng-repeat="salesperson in M_CO.salesPersonList track by $index"
                                                                        ng-mousedown="F_CO.Deal.selectSalesPerson(salesperson)" 
                                                                        ng-class="{'selected-row': $index ==  M_CO.Deal.DealSalesPersonCurrentIndex}"
                                                                        id="DealSalesPerson{{$index}}" >
                                                                        <div class="form-group-info col-xs-12 P0">
                                                                            <span >{{salesperson.TechnicianName}}</span>
                                                                        </div>
                                                                    </li>  
                                                                </ul>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                  <div class = "col-xs-12 dealQuotation"  ng-if = "GroupOnlyPermissions['Costs']['modify']">
                                                        <label class = "col-xs-12">{{'Commission_Earned' | translate}}</label>
                                                        <div class="col-xs-12 P0">
                                                            <numbers-only id-value = "working-days"
                                                              class-value = "bp-input-text"
                                                              input-model-value = "M_CO.Deal.DealInfo.DealCommission" 
                                                              include-negative = "false"
                                                              include-zero = "true"
                                                              precision-length = "2"
                                                              place-holder-value="{{'Please_enter_amount' | translate}}"
                                                              max-length = '16'
                                                              include-blank = 'true'
                                                              disabled-value=" M_CO.Deal.DealInfo.DealStatus == 'Invoiced' "
                                                              blur-value = "F_CO.Deal.saveDealCommissionInfo()"
                                                              />
                                                          </div>
                                                  </div>  
                                            </div>
                                            <!-- disabled-value = "GroupOnlyPermissions['Deal']['create/modify']" -->
                                           
                                            
                                            <div class = "col-xs-12 col-sm-6 form-container">
                                                <div class = "col-xs-12 dealTotalSummary">
                                                    <label class = "col-xs-6 bp-font-16">{{'Deal_total' | translate}}</label>
                                                </div>
                                                <div class = "col-xs-12 dealTotalSummary">
                                                    <label class = "col-xs-6 MT20">{{'SalesTaxGridItem_Units' | translate}}
                                                    <p ng-if="F_CO.isDealActionEnable() && !F_CO.isCommitAndInstallActionDone() && GroupOnlyPermissions['Deal']['create/modify']" ng-click="F_CO.addUnitToDeal()">{{'Label_Add' | translate}}</p>
                                                    </label>
                                                    
                                                    <span class = "col-xs-6 bp-dark-grey1-font MT20">{{M_CO.Deal.DealInfo.UnitsTotal | currency}}</span>
                                                </div>
                                                <div class = "col-xs-12 dealTotalSummary">
                                                    <label class = "col-xs-6">{{'Trade_ins' | translate}}
                                                     <p ng-if="F_CO.isDealActionEnable()  && GroupOnlyPermissions['Deal']['create/modify']" ng-click="F_CO.addTradeInToDeal()">{{'Label_Add' | translate}}</p>
                                                    </label>
                                                   
                                                    <span class = "col-xs-6 bp-dark-grey1-font "  ng-if = "M_CO.Deal.DealInfo.TradeInsTotal >= 0">
                                                        {{M_CO.Deal.DealInfo.TradeInsTotal != null ? M_CO.Deal.DealInfo.TradeInsTotal : 0  | currency}}
                                                    </span>
                                                    <span class = "col-xs-6 bp-dark-grey1-font"  ng-if = "M_CO.Deal.DealInfo.TradeInsTotal < 0">
                                                        ({{(M_CO.Deal.DealInfo.TradeInsTotal != null ? (M_CO.Deal.DealInfo.TradeInsTotal)*-1 : 0) | currency}})
                                                    </span>
                                                </div>
                                                <div class = "col-xs-12 dealTotalSummary">
                                                    <label class = "col-xs-6">{{'Lien_payout' | translate}}</label>
                                                    <span class = "col-xs-6 bp-dark-grey1-font">{{M_CO.Deal.DealInfo.LienPayoutTotal != null ? M_CO.Deal.DealInfo.LienPayoutTotal : 0  | currency}}</span>
                                                </div>
                                                <div class = "col-xs-12 dealTotalSummary">
                                                    <label class = "col-xs-6">{{'Parts_labor' | translate}}</label>
                                                    <span class = "col-xs-6 bp-dark-grey1-font">{{M_CO.Deal.DealInfo.PartsAndLabourTotals != null ? M_CO.Deal.DealInfo.PartsAndLabourTotals : 0  | currency}}</span>
                                                </div>
                                                <div class = "col-xs-12 dealTotalSummary">
                                                    <label class = "col-xs-6">{{'Other_products' | translate}}</label>
                                                    <span class = "col-xs-6 bp-dark-grey1-font ">{{M_CO.Deal.DealInfo.OtherProductsTotal != null ? M_CO.Deal.DealInfo.OtherProductsTotal : 0  | currency}}</span>
                                                </div>
                                                <div class = "col-xs-12 dealTotalSummary">
                                                    <label class = "col-xs-6">{{'Fees' | translate}}</label>
                                                    <span class = "col-xs-6 bp-dark-grey1-font ">{{M_CO.Deal.DealInfo.FeesTotal != null ? M_CO.Deal.DealInfo.FeesTotal : 0 | currency}}</span>
                                                </div>
                                                <div class = "col-xs-12 dealTotalSummary" ng-if="CompanyLocale == 'Australia'">
                                                    <label class = "col-xs-6">{{'Stamp_duty' | translate}}</label>
                                                    <span class = "col-xs-6 bp-dark-grey1-font ">{{(M_CO.Deal.DealInfo.StampDutyTotal != null ? M_CO.Deal.DealInfo.StampDutyTotal : 0)| currency}}</span>
                                                </div>
                                               <div class = "col-xs-12 dealTotalSummary" ng-If="!M_CO.Deal.DealSummaryObj.IsTaxIncludingPricing">
                                                        <label class = "col-xs-6 bp-font-14">{{'Sales_taxes' | translate}}</label>
                                                        <span class = "col-xs-6 bp-dark-grey1-font bp-font-14" >{{ (M_CO.Deal.DealInfo.SalesTaxesTotal ? M_CO.Deal.DealInfo.SalesTaxesTotal : 0) | currency}}</span>
                                                    </div>
                                                <div class = "col-xs-12 dealTotalSummary">
                                                    <label class = "col-xs-6 bp-font-14 text-uppercase" ng-class="{'PL10': M_CO.Deal.DealInfo.DealType == 'Financed'}">{{'Deal_total' | translate}}</label>
                                                    <span class = "col-xs-6 bp-dark-grey1-font bp-font-14 bp-bold-font " >{{ (M_CO.Deal.DealInfo.Total ? M_CO.Deal.DealInfo.Total : 0) | currency}}</span>
                                                </div>
                                                <div ng-if = "M_CO.Deal.DealInfo.DealType == 'Financed'">
                                                    <div class = "col-xs-12 dealTotalSummary">
                                                        <label class = "col-xs-6 bp-font-14">{{'Financing_products' | translate}}</label>
                                                        <span class = "col-xs-6 bp-dark-grey1-font bp-font-14 " ng-If="!M_CO.Deal.DealSummaryObj.IsTaxIncludingPricing" >{{ (M_CO.Deal.DealInfo.FIProductTotal ? M_CO.Deal.DealInfo.FIProductTotal : 0) | currency}}</span>
                                                        <span class = "col-xs-6 bp-dark-grey1-font bp-font-14 " ng-If="M_CO.Deal.DealSummaryObj.IsTaxIncludingPricing" >{{ (F_CO.DealFinance.getFIProductTotal() ? F_CO.DealFinance.getFIProductTotal() : 0) | currency}}</span>
                                                    </div>
                                                     <div class = "col-xs-12 dealTotalSummary" ng-If="!M_CO.Deal.DealSummaryObj.IsTaxIncludingPricing">
                                                        <label class = "col-xs-6 bp-font-14">{{'Sales_taxes' | translate}}</label>
                                                        <span class = "col-xs-6 bp-dark-grey1-font bp-font-14 " >{{ (M_CO.Deal.DealInfo.FIProductTaxTotal ? M_CO.Deal.DealInfo.FIProductTaxTotal : 0) | currency}}</span>
                                                    </div>
                                                    <div class = "col-xs-12 dealTotalSummary">
                                                        <label class = "col-xs-6 bp-font-14 PL10 text-uppercase">{{'Label_Total' | translate}}</label>
                                                        <span class = "col-xs-6 bp-dark-grey1-font bp-font-14 bp-bold-font " > {{ F_CO.getDealTotal() | currency}}</span>
                                                    </div>
                                                    <div class = "col-xs-12 dealTotalSummary">
                                                        <label class = "col-xs-6 bp-font-14">{{'Less' | translate}}:{{'Down_payment' | translate}}</label>
                                                        <span class = "col-xs-6 bp-dark-grey1-font bp-font-14 " >({{ (M_CO.Deal.DealFinanceObj.DownPayment ? M_CO.Deal.DealFinanceObj.DownPayment : 0) | currency}})</span>
                                                    </div>
                                                    <div class = "col-xs-12 dealTotalSummary">
                                                        <label class = "col-xs-6 bp-font-14 PL10 text-uppercase">{{'AMOUNT_FINANCED' | translate}}</label>
                                                        <span class = "col-xs-6 bp-dark-grey1-font bp-font-14 bp-bold-font" >{{ (F_CO.DealFinance.getAmountFinanced() ? F_CO.DealFinance.getAmountFinanced() : 0 ) | currency}}</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- End: Deal Summary accordian end here -->
                                <!-- End: inner Accordian level 1 -->
                                
                                <!-- Start: Deal Unresolved fulfillment section -->
                                <div class="bp-inner-accordian open bp-inner-accordian-deal" ng-if="M_CO.Deal.DealUnresolvedFulfillmentList.length > 0" ng-class="{'bp-inner-accordian-opened': M_CO.expandedInnerSectionName == 'Deal_UnrslvdFlflmnt', 'bp-inner-accordian-opened-deal': M_CO.expandedInnerSectionName == 'Deal_UnrslvdFlflmnt'}">
                                    <div class="inner-accordian-header col-md-12" ng-click = "F_CO.expandOrCollapseInnerSection('Deal_UnrslvdFlflmntSectionId', 'Deal_UnrslvdFlflmnt')">
                                        <div class="inner-accordian-header-left">
                                           <h2 class="accordian-left-details">{{'Unresolved_fulfillments' | translate}}
                                            <span class="badge bp-yellow-dark" ng-if="M_CO.Deal.DealUnresolvedFulfillmentList.length > 0 && M_CO.expandedInnerSectionName != 'Deal_UnrslvdFlflmnt'">{{M_CO.Deal.DealUnresolvedFulfillmentList.length}}</span>
                                            </h2>
                                        </div>
                                        <div class="accordian-right-details">
                                            <a class="down-arrow-icon" ng-if = "M_CO.expandedInnerSectionName != 'Deal_UnrslvdFlflmnt'">
                                                <i ng-include="'{!Application_Images}/Icons/arrowDown.svg'" class="blue_008DC1"></i>
                                            </a>
                                            <a class="down-arrow-icon" ng-if = "M_CO.expandedInnerSectionName == 'Deal_UnrslvdFlflmnt'">
                                                <i ng-include="'{!Application_Images}/Icons/arrowUp.svg'" class="blue_008DC1"></i>
                                            </a>
                                            <div class="accordian-right-details-text">
                                           </div>
                                        </div>
                                    </div>

                                    <div class="inner-accordian-body bp-light-gray4 col-md-12 bp-collapse-div-transition P0"  
                                        id="Deal_UnrslvdFlflmntSectionId"
                                        ng-class="{'bp-expand-div-transition': M_CO.expandedInnerSectionName == 'Deal_Details'}">
                                        <div class="expandableContainer Deal_UnrslvdFlflmntSectionWrapper">
                                            <div class="table-responsive" ng-if = "M_CO.Deal.DealUnresolvedFulfillmentList.length > 0">
                                            <table class = "bp-editable-table SOJobItemsGrid Deal_UnrslvdFlflmntSection">
                                                <col width="5%"  />
                                                <col width="10%"  />
                                                <col width="23%"  />
                                                <col width="29%"  />
                                                <col width="10%"  />
                                                <col width="18%"  />
                                                <col width="5%"  />
                                                <thead>
                                                    <tr>
                                                        <th></th>
                                                        <th class = "bp-text-uppercase">{{'Item_description' | translate}}</th>
                                                        <th class = "bp-text-uppercase text-center">{{'For_unit' | translate}}</th>
                                                        <th class = "bp-text-uppercase text-center">{{'What_changed' | translate}}</th>
                                                        <th class = "bp-text-uppercase text-center">{{'User_Object_Display_Label' | translate}}</th>
                                                        <th class = "bp-text-uppercase text-left">{{'Label_Action_Required' | translate}}</th>
                                                        <th class = "bp-text-uppercase"></th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr class = "bp-expanded-deletable-div-transition" id = "Deal_UnrslvFlflmnt{{DealUnrslvFlflmntIndex}}" 
                                                        ng-repeat="dealUnrslFlflmntObj in M_CO.Deal.DealUnresolvedFulfillmentList" ng-init="DealUnrslvFlflmntIndex = $index" ng-click = "F_CO.resolveDealUnresolvedFulFillment(dealUnrslFlflmntObj)">
                                                        <td ng-class = "{'setBgColor' : M_CO.editLineItem == 'Deal_UnrslvFlflmnt{{DealUnrslvFlflmntIndex}}','inactive-link':!GroupOnlyPermissions['Deal']['create/modify']}">
                                                             <i ng-include="'{!Application_Images}/Icons/part.svg'" ng-if="dealUnrslFlflmntObj.PartId"
                                                                class="grey bp-pointer-cursor pull-left itemSvg"></i>
                                                            <i ng-include="'{!Application_Images}/Icons/labor.svg'" ng-if="dealUnrslFlflmntObj.LabourId"
                                                                class="grey bp-pointer-cursor pull-left itemSvg"></i>    
                                                            <i ng-include="'{!Application_Images}/Icons/fee_V2.svg'" ng-if="dealUnrslFlflmntObj.FeeId"
                                                                class="grey bp-pointer-cursor pull-left itemSvg"></i>
                                                            <i ng-include="'{!Application_Images}/Icons/sublet.svg'" ng-if="dealUnrslFlflmntObj.SubletId"
                                                                class="grey bp-pointer-cursor pull-left itemSvg"></i>
                                                            <i ng-include="'{!Application_Images}/Icons/kit.svg'" ng-if="dealUnrslFlflmntObj.COKitHeaderId || dealUnrslFlflmntObj.SOKitHeaderId || dealUnrslFlflmntObj.DealKitHeaderId"
                                                                class="grey bp-pointer-cursor pull-left itemSvg"></i>
                                                        </td>
                                                        <td class="boldText" ng-class = "{'setBgColor' : M_CO.editLineItem == 'Deal_UnrslvFlflmnt{{DealUnrslvFlflmntIndex}}' ,'inactive-link':!GroupOnlyPermissions['Deal']['create/modify']}">
                                                           
                                                            <div class="liItemDesc_setTextEllipsis"
                                                                ng-if="(M_CO.editLineItem != 'Deal_UnrslvFlflmnt' + DealUnrslvFlflmntIndex)">
                                                                <span>{{dealUnrslFlflmntObj.ItemCode}} - {{dealUnrslFlflmntObj.ItemDescription}}</span>
                                                            </div>
                                                        </td>
                                                        <td class="text-center" ng-class = "{'setBgColor' : M_CO.editLineItem == 'Deal_UnrslvFlflmnt{{DealUnrslvFlflmntIndex}}' ,'inactive-link':!GroupOnlyPermissions['Deal']['create/modify']}">
                                                            <span>{{dealUnrslFlflmntObj.RequiredForUnit}}</span>
                                                        </td>
                                                        <td class="text-center" ng-class = "{'setBgColor' : M_CO.editLineItem == 'Deal_UnrslvFlflmnt{{DealUnrslvFlflmntIndex}}' ,'inactive-link':!GroupOnlyPermissions['Deal']['create/modify']}">
                                                            <div class="InnerFlexContainer">
                                                                {{M_CO.DealUnresolvedFulfillmentMap[dealUnrslFlflmntObj.Type]}} <span ng-if = "dealUnrslFlflmntObj.Type != 'Updated'">:</span>
                                                                <span  ng-if = "dealUnrslFlflmntObj.Type == 'Added'" class =" text-right PL5">{{'Label_Quantity' | translate}} = {{dealUnrslFlflmntObj.UpdatedQty}}</span>
                                                                <span ng-if = "dealUnrslFlflmntObj.Type == 'Updated'" class =" text-right PL5">{{'Label_From' | translate}} {{dealUnrslFlflmntObj.ActualQty}} to {{dealUnrslFlflmntObj.UpdatedQty}}</span>
                                                                <span ng-if = "dealUnrslFlflmntObj.Type == 'Removed'" class =" text-right PL5">{{'Label_Quantity' | translate}} = {{dealUnrslFlflmntObj.UpdatedQty}}</span>
                                                            </div> 
                                                        </td>
                                                        <td class="text-center" ng-class = "{'setBgColor' : M_CO.editLineItem == 'Deal_UnrslvFlflmnt{{DealUnrslvFlflmntIndex}}' ,'inactive-link':!GroupOnlyPermissions['Deal']['create/modify']}">
                                                            <span>{{dealUnrslFlflmntObj.User}}</span>
                                                        </td>
                                                      <td class="text-left boldText bp-red-font bp-text-lowerCase" ng-class = "{'setBgColor' : M_CO.editLineItem == 'Deal_UnrslvFlflmnt{{DealUnrslvFlflmntIndex}}' ,'inactive-link':!GroupOnlyPermissions['Deal']['create/modify']}">
                                                            <span >{{dealUnrslFlflmntObj.ActionRequired}}</span>
                                                        </td>
                                                        <td ng-class = "{'setBgColor' : M_CO.editLineItem == 'Deal_UnrslvFlflmnt{{DealUnrslvFlflmntIndex}}' ,'inactive-link':!GroupOnlyPermissions['Deal']['create/modify']}">
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                    </div>
                                </div>
                                <!-- End: Deal Unresolved fulfillment section -->
                                
                                <!-- Start: inner Accordian level 1 -->
                                <!-- Start: Deal Unit accordian start here -->
                                <div class="bp-inner-accordian open bp-inner-accordian-deal" ng-repeat="unit in M_CO.Deal.UnitList" ng-init="UnitIndex = $index" ng-class="{'bp-inner-accordian-opened': M_CO.expandedInnerSectionName == 'Deal_DU{{$index}}', 'bp-inner-accordian-opened-deal': M_CO.expandedInnerSectionName == 'Deal_DU{{$index}}'}">
                                    <div class="inner-accordian-header col-md-12" ng-click = "F_CO.expandOrCollapseInnerSection('Deal_DU'+$index+'_SectionId', 'Deal_DU'+$index)">
                                        <div class="inner-accordian-header-left">
                                            <h2 class="accordian-left-details" ng-if="unit.DealItemObj.UnitId != null && unit.DealItemObj.UnitType != 'ORDU'">{{unit.DealItemObj.StockNumber}}
                                                <span class="bp-req-icon" ng-if = "M_CO.expandedInnerSectionName != 'Deal_DU'+$index && M_CO.dealOptionsAndFeesStatusMap[M_CO.Deal.OptionStatus].length">!</span>
                                            </h2>
                                            <h2 class="accordian-left-details" ng-if="unit.DealItemObj.UnitId != null && unit.DealItemObj.UnitType == 'ORDU' ">{{unit.DealItemObj.UnitNumber}}
                                                <span class="bp-req-icon" ng-if = "M_CO.expandedInnerSectionName != 'Deal_DU'+$index && M_CO.dealOptionsAndFeesStatusMap[M_CO.Deal.OptionStatus].length">!</span>
                                            </h2>
                                            <h2 class="accordian-left-details" ng-if="unit.DealItemObj.UnitId == null && unit.DealItemObj.Make != null">{{'Temporary_unit' | translate}} {{UnitIndex + 1}}</h2>
                                            <h2 class="accordian-left-details" ng-if="unit.DealItemObj.UnitId == null && unit.DealItemObj.Make == null">{{'Unit_Make_Object_Display_Label' | translate}} {{UnitIndex + 1}}</h2>
                                            <div class="show-onclse" ng-if="M_CO.expandedInnerSectionName != 'Deal_DU'+$index">
                                                {{unit.DealItemObj.FormattedName}}
                                            </div>
                                        </div>
                                        <div class="accordian-right-details">
                                            <a class="down-arrow-icon" ng-if = "M_CO.expandedInnerSectionName != 'Deal_DU'+$index">
                                                <i ng-include="'{!Application_Images}/Icons/arrowDown.svg'" class="blue_008DC1"></i>
                                            </a>
                                            <a class="down-arrow-icon" ng-if = "M_CO.expandedInnerSectionName == 'Deal_DU'+$index">
                                                <i ng-include="'{!Application_Images}/Icons/arrowUp.svg'" class="blue_008DC1"></i>
                                            </a>
                                            
                                             <div class="accordian-right-details-text" ng-if = "M_CO.expandedInnerSectionName == 'Deal_DU'+$index  && F_CO.isDealActionEnable() && !F_CO.isCommitAndInstallActionDone()">
                                                <p class="right-text required" ng-if = "M_CO.expandedInnerSectionName == 'Deal_DU'+$index && GroupOnlyPermissions['Deal']['create/modify'] && (!(F_CO.isSingleSKUPresent() && F_CO.TradeIn.isAnyCOUStocked() && unit.DealItemObj.UnitId != null))">
                                                    <span class="bp-font-14 bp-blue-font bp-cursor-pointer" ng-click="F_CO.openRemoveUnitModalFromDeal(UnitIndex, $event)">{{'Remove_unit' | translate}}</span> 
                                                    <span class="icon-container" ng-click="F_CO.openRemoveUnitModalFromDeal(UnitIndex, $event)">
                                                        <i ng-include="'{!Application_Images}/Icons/trash_filled.svg'" class="icon_fill_blue bp-pointer-cursor bp-svg-19"></i>
                                                    </span>
                                                </p>
                                            </div>
                                            <div class="accordian-right-details-text" ng-if="M_CO.expandedInnerSectionName != 'Deal_DU'+$index">
                                                <p class="bp-dark-grey1-font right-text required" ng-if="M_CO.expandedInnerSectionName != 'Deal_DU'+$index">
                                                    <span class="bp-dark-grey1-font bp-font-16">{{'Label_Total' | translate}}: {{unit.Total | currency}}</span> 
                                                </p>
                                            </div>
                                         </div>
                                    </div>
                                    <div class="inner-accordian-body bp-light-gray4 col-md-12 bp-collapse-div-transition deal-wrapper P0" id="Deal_DU{{$index}}_SectionId"
                                        ng-class="{'bp-expand-div-transition': M_CO.expandedInnerSectionName == 'Deal_DU{{$index}}'}">
                                        <div class="expandableContainer unitSectionBody">
                                            
                                            <!-- Start: inner Accordian level 2 -->
                                            <!-- Start: Deal Unit Info accordian start here -->
                                            <div class="bp-inner-accordian second-level open"
                                                ng-class="{'bp-inner-accordian-opened': M_CO.expandedInner2SectionName == 'Deal_DU{{$index}}_Info', 'bp-border-bottom-none': unit.DealItemObj.UnitId == null && unit.DealItemObj.Make == null}">
                                                <div class="inner-accordian-header col-md-12" ng-click = "F_CO.expandOrCollapseInner2Section('Deal_DU'+$index+'_InfoSectionId', 'Deal_DU'+$index+'_Info')">
                                                    <div class="inner-accordian-header-left">
                                                        <h2 class="accordian-left-details">{{'Unit_details' | translate}}</h2>
                                                        <div class="show-onclse" ng-if="M_CO.expandedInner2SectionName != 'Deal_DU'+$index+'_Info'">
                                                            {{unit.DealItemObj.FormattedName}}
                                                        </div>
                                                    </div>
                                                    <div class="accordian-right-details">
                                                        <a class="down-arrow-icon" ng-if = "M_CO.expandedInner2SectionName != 'Deal_DU'+$index+'_Info'">
                                                            <i ng-include="'{!Application_Images}/Icons/arrowDown.svg'" class="blue_008DC1"></i>
                                                        </a> 
                                                        <a class="down-arrow-icon" ng-if = "M_CO.expandedInner2SectionName == 'Deal_DU'+$index+'_Info'">
                                                            <i ng-include="'{!Application_Images}/Icons/arrowUp.svg'" class="blue_008DC1"></i>
                                                        </a>
                                                         <div class="accordian-right-details-text">
                                                            <p class="bp-dark-grey1-font right-text required" ng-if="M_CO.expandedInner2SectionName != 'Deal_DU'+$index+'_Info'">
                                                                <span class="bp-dark-grey1-font bp-font-16">{{'Label_Total' | translate}}: {{unit.Total | currency}}</span> 
                                                            </p>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="inner-accordian-body bp-light-gray4 col-md-12 bp-collapse-div-transition P0" id="Deal_DU{{$index}}_InfoSectionId"
                                                    ng-class="{'bp-expand-div-transition': M_CO.expandedInner2SectionName == 'Deal_DU{{$index}}_Info'}">
                                                    <div>
                                                        <div class="expandableContainer" ng-if="unit.DealItemObj.UnitId != null || (unit.DealItemObj.UnitId == null && unit.DealItemObj.Make != null)">
                                                            <div class="second-level-accordian__content">
                                                                 <div class="left">
                                                                    <div class="block-text" ng-if="unit.DealItemObj.UnitId == null">
                                                                         <h3 class="bp-blue-font bp-blue-hover" ng-if="unit.DealItemObj.UnitId == null" ng-click="F_CO.openAddEditTempUnitPopup(unit.DealItemObj.Id, UnitIndex,'Deal Unit', 'Temp Unit')">{{'Temporary_unit' | translate}} {{UnitIndex + 1}}</h3>
                                                                         <p class="bp-dark-grey1-font teampUnitDetails" ng-if="unit.DealItemObj.UnitId == null">
                                                                             <span class="bp-bold-font"></span>
                                                                             <span class="bp-bold-font teampUnitDetailsMAke">
                                                                                {{unit.DealItemObj.MakeName != null ? unit.DealItemObj.MakeName : ''}}{{unit.DealItemObj.ModelName != null ? ' '+unit.DealItemObj.ModelName : ''}}{{unit.DealItemObj.SubModelName != null ? ' '+unit.DealItemObj.SubModelName : ''}}{{unit.DealItemObj.Year != null ? ' '+unit.DealItemObj.Year : ''}}{{unit.DealItemObj.ExteriorColour != null ? ', ' + unit.DealItemObj.ExteriorColour : ''}}
                                                                             </span>
                                                                         </p>
                                                                         <p class="bp-dark-grey1-font" ng-if="unit.DealItemObj.UnitId != null">
                                                                             <span class="bp-bold-font">{{'Label_VIN' | translate}}: </span>
                                                                             <span class="vinNumber bp-word-break-all bp-lh-15">{{unit.DealItemObj.VIN}} <!-- 1GKKVTKDXFJ186780 --></span>
                                                                         </p>
                                                                         <p class="bp-dark-grey1-font" ng-if="unit.DealItemObj.UnitNumber != null">
                                                                             <span class="bp-bold-font">{{'Stock_number' | translate}}: </span>
                                                                             <span>{{unit.DealItemObj.StockNumber}} <!-- SKU-00026 --></span>
                                                                         </p>
                                                                         <p class="bp-dark-grey1-font">
                                                                             <span class="bp-filled-circle sku-status-circle" ng-class="{'bp-grey-filled-circle': unit.DealItemObj.UnitId == null, 'bp-coral-filled-circle': unit.DealItemObj.Status == 'Reserved'}"></span>
                                                                             <span class="bp-bold-font bp-grey-font text-uppercase sku-status">{{unit.DealItemObj.UnitId != null ? unit.DealItemObj.Status : 'Temporary'}}</span>
                                                                         </p>
                                                                    </div>
                                                                    <div class="ror_link" ng-if="unit.DealItemObj.UnitId == null && GroupOnlyPermissions['Deal']['create/modify'] && F_CO.isDealActionEnable() && !F_CO.isCommitAndInstallActionDone()">
                                                                        <a class="bp-blue-font bp-bold-font" ng-click="F_CO.replaceUnitFromUnitCard(UnitIndex)">{{'Replace_unit' | translate}}</a> 
                                                                    </div>
                                                                         <info-card-component ng-if="unit.DealItemObj.UnitId != null" id-value="couInfoCardId" override-css="altered-info-card"
                                                                            header-link-action="F_CO.moveToState('ViewUnit', {Id : unit.DealItemObj.UnitId}, true)" 
                                                                            object-payload="M_CO.unitIdToUnitImagesJsonMap[unit.DealItemObj.UnitId].unitCardInfoPayload"
                                                                            hyperlink-action="F_CO.replaceUnitFromUnitCard(UnitIndex)"
                                                                            image-action="F_CO.openImageCarousel(unit.DealItemObj.UnitId)">
                                                                            <div class="bp-dark-grey1-font bp-flex-col">
                                                                                 <span class="bp-filled-circle sku-status-circle" ng-class="{'bp-grey-filled-circle': unit.DealItemObj.UnitId == null, 'bp-coral-filled-circle': unit.DealItemObj.Status == 'Reserved', 'bp-orange-filled-circle' : unit.DealItemObj.Status == 'On Order'}"></span>
                                                                                 <span ng-class="{'bp-orange-light-font' : unit.DealItemObj.Status == 'On Order' }" class="bp-bold-font bp-grey-font text-uppercase sku-status">{{unit.DealItemObj.UnitId != null ? unit.DealItemObj.Status : 'Temporary'}}</span>
                                                                             </div>
                                                                         </info-card-component>
                                                                         <div class="deal-tax-details" ng-if="unit.DealItemObj.UnitId != null">
                                                                        <div class="row M0">
                                                                            <div class="col-lg-2 col-xs-3 lables bp-bold-font bp-dark-grey1-font P0 bp-font-16">{{'ViewLabour_Taxable' | translate}}</div>
                                                                            <div class="col-lg-8 col-xs-8 values bp-dark-grey1-font">
                                                                                <label class="bp-switch"> 
                                                                                    <input ng-model="unit.DealItemObj.Taxable" type="checkbox" ng-disabled="((!GroupOnlyPermissions['Sales Taxes']['assign']) || (M_CO.Deal.DealInfo.DealStatus === 'Invoiced'))"
                                                                                        ng-change="F_CO.saveDealItemTaxInfo(unit.DealItemObj.Taxable, unit.DealItemObj.ApplicableTaxId, unit.DealItemObj.Id, UnitIndex, 'unit')"/>
                                                                                    <div class="bp-slider round"></div>
                                                                                </label>
                                                                            </div>
                                                                        </div>
                                                                        <div class="row M0" ng-if="unit.DealItemObj.Taxable">
                                                                            <label class="col-xs-12">{{'Applicable_tax_Label' | translate}}</label>
                                                                            <div class="col-xs-12 P0">   
                                                                                <div class="account-type-container">
                                                                                     <div class = "bp-autocomplete-Wrapper autocomplete_v2">
                                                                                          <span class = "bp-autocomplete-image-icon">
                                                                                              <i ng-include="'{!Application_Images}/Icons/arrowDown.svg'" class="bp-blue bp-cursor-pointer svg_width_2px" ng-click = "F_CO.setFocusOnInput('dealUnitSalesTaxRec')"></i>
                                                                                          </span>
                                                                                          <input  type="text" id="dealUnitSalesTaxRec" class="bp-autocomplete-input bp-cursor-pointer bp-input-text  manage-long-salesperson-person" placeholder="{{'Please_select' | translate }}"
                                                                                            autocomplete="off" ng-keyup="F_CO.keyPressNavigationOnDropdownElements($event, 'dealUnitSalesTaxRecDropdownDiv', 'dealUnitSalesTaxRec', M_CO.applicableSalesTaxList)"
                                                                                            ng-model="unit.DealItemObj.ApplicableTaxName" 
                                                                                            ng-focus = "M_CO.showSalesTaxListDropdown = true; F_CO.setDealApplicableTaxDefaultDataOnFocus(unit.DealItemObj.Id, UnitIndex, 'unit', unit.DealItemObj.Taxable);"
                                                                                            ng-blur="M_CO.showSalesTaxListDropdown = false; F_CO.hideDropdown();" readonly="readonly" 
                                                                                            ng-disabled="((!GroupOnlyPermissions['Sales Taxes']['assign']) || (M_CO.Deal.DealInfo.DealStatus === 'Invoiced'))"/>                       
                                                                                            <div class = "bp-autocomplete-dropdown-wrapper" ng-if="M_CO.showSalesTaxListDropdown" id="dealUnitSalesTaxRecDropdownDiv">
                                                                                                <ul>
                                                                                                    <li ng-repeat="salesTax in M_CO.applicableSalesTaxList track by $index" id="dealUnitSalesTaxRec_{{$index}}"
                                                                                                       ng-class="{'selected-row': $index == M_CO.currentDropDownIndex}"
                                                                                                       ng-mousedown="F_CO.selcectDealItemSalesTax(salesTax)">
                                                                                                        <div class="form-group-info col-xs-12 P0">
                                                                                                            <span >{{salesTax.Name}}</span>
                                                                                                        </div>
                                                                                                    </li> 
                                                                                                </ul>
                                                                                                 <ul ng-If="M_CO.applicableSalesTaxList.length == 0">
                                                                                                    <li id="unitSalesTaxNoResults" class="BP_angucomplete-row-NoResults-Msg">
                                                                                                        <div class="">{{'No_Results_Found' | translate}}</div>
                                                                                                    </li>
                                                                                                </ul>
                                                                                            </div>
                                                                                      </div>
                                                                                </div>
                                                    
                                                    
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    
                                                                        
                                                                    <div class="bp-orange-dark-font dealStatusValue required deal-warning-msg-container" ng-if="M_CO.dealOptionsAndFeesStatusMap[M_CO.Deal.OptionStatus].length">
                                                                        <span class="req-icon">!</span>
                                                                        <span class="warning-msg">
                                                                            <p class = "dealquation M0">{{M_CO.dealOptionsAndFeesStatusMap[M_CO.Deal.OptionStatus][0]}}</p>
                                                                            <span class = "dealquation bp-bold-font">{{'Label_Action_Required' | translate}}:</span><span class = "dealquation action-text"> {{M_CO.dealOptionsAndFeesStatusMap[M_CO.Deal.OptionStatus][1]}}</span>
                                                                        </span>
                                                                       
                                                                    </div>
                                                                 </div>
                                                                 <div class="right">
                                                                    <div class="row M0 PT0" ng-if="CompanyLocale == 'Australia'">
                                                                        <div class="col-lg-8 col-xs-8 lables bp-bold-font bp-dark-grey1-font">{{ 'Enforce_rideway_pricing' | translate }}</div>
                                                                        <!-- <div class="col-lg-4 col-md-4 values bp-dark-grey1-font">
                                                                         <div class="action">
                                                                            <label class="switch ">
                                                                                <input type="checkbox" />
                                                                                <div class="slider round"></div>
                                                                            </label>
                                                                         </div>
                                                                        </div> -->
                                                                    <div class="col-lg-4 col-md-4 values bp-dark-grey1-font">{{unit.IsRideawayPricingEnabled ? 'YES' : 'NO'}}</div>
                                                                    </div>
                                                                    <div class="row M0" ng-if="CompanyLocale == 'Australia' && unit.IsRideawayPricingEnabled">
                                                                        <div class="col-lg-8 col-xs-8 lables bp-bold-font bp-dark-grey1-font"></div>
                                                                        <div class="col-lg-4 col-md-4 values bp-purple-font bp-bold-font">{{unit.TotalEnforceRideawayPrice | currency}} <!-- $12,500.00 --></div>
                                                                    </div>
                                                                    <div class="row M0">
                                                                        <div class="col-lg-8 col-xs-8 lables bp-bold-font bp-dark-grey1-font">{{ 'Base_unit_price' | translate }}</div>
                                                                        <div class="col-lg-4 col-md-4 values bp-dark-grey1-font">
                                                                            <span ng-class="{'locked': unit.IsRideawayPricingEnabled}">{{unit.TotalBasePrice | currency}} <!-- $12,500.00 --></span>
                                                                        </div>
                                                                    </div>
                                                                    <div class="row M0">
                                                                        <div class="col-lg-8 col-xs-8 lables bp-bold-font bp-dark-grey1-font">{{ 'Factory_options' | translate }}</div>
                                                                        <div class="col-lg-4 col-md-4 values bp-dark-grey1-font">{{unit.TotalFactoryOption | currency}} <!-- $0.00 --></div>
                                                                    </div>
                                                                    <div class="row M0">
                                                                        <div class="col-lg-8 col-xs-8 lables bp-bold-font bp-dark-grey1-font">{{ 'Dealer_installed_options' | translate }}</div>
                                                                        <div class="col-lg-4 col-md-4 values bp-dark-grey1-font">{{unit.TotalDealerInstalledOption | currency}} <!-- $0.00 --></div>
                                                                    </div>
                                                                    <div class="row M0">
                                                                        <div class="col-lg-8 col-xs-8 lables bp-bold-font bp-dark-grey1-font">{{ 'Options_and_fees' | translate }}</div>
                                                                        <div class="col-lg-4 col-md-4 values bp-dark-grey1-font">{{unit.TotalOptionAndFeeWithKit | currency}} <!-- $150.00 --></div>
                                                                    </div>
                                                                    <div class="row M0" ng-if="CompanyLocale == 'Australia'">
                                                                        <div class="col-lg-8 col-xs-8 lables bp-bold-font bp-dark-grey1-font">{{ 'Stamp_duty' | translate }}</div>
                                                                        <div class="col-lg-4 col-md-4 values bp-dark-grey1-font">
                                                                            <span ng-class="{'locked': unit.IsRideawayPricingEnabled}">{{unit.TotalStampDuty | currency}} <!-- $0.00 --></span>
                                                                        </div>
                                                                    </div>
                                                                    <div class="row M0">
                                                                        <div class="col-lg-8 col-xs-8 lables bp-bold-font">
                                                                            <a class="bp-blue-font"  ng-if="(M_CO.Deal.DealInfo.DealStatus != 'Invoiced' && M_CO.Deal.DealInfo.DealStatus != 'Approved') && GroupOnlyPermissions['Deal']['create/modify']" ng-click="F_CO.openEditPricingPopup(UnitIndex)">{{ 'Edit_pricing' | translate }}</a>
                                                                       </div>                                                              
                                                                    </div>
                                                                </div>
                                                            </div> 
                                                        </div>
                                                        <div class="select-customer-section unit" ng-if="(unit.DealItemObj.UnitId == null && unit.DealItemObj.Make == null) || M_CO.isReplaceUnit">
                                                        <div class="left dealsectionUnitSearch">
                                                            <label>{{ 'Search_for_a_stock_unit' | translate }}</label>
                                                             <autocompletev2 id="autocomple
                                                             tev2SKUId"
                                                                template-name="Entity"
                                                                section-name="Stock Unit"
                                                                unit-index="{{UnitIndex}}"
                                                                section-id="DealUnit{{UnitIndex}}"
                                                                is-disabled="!GroupOnlyPermissions['Deal']['create/modify']"/>
                                                        </div>
                                                        <div class="right MT7">
                                                            <button  ng-disabled = "!GroupOnlyPermissions['Deal']['create/modify']" ng-if="unit.DealItemObj.UnitId == null && unit.DealItemObj.Make == null && M_CO.Deal.DealInfo.DealStatus == 'Quotation'" class="bp-btn bp-btn-normal temporary-unit-btn" ng-click="F_CO.openAddEditTempUnitPopup(unit.DealItemObj.Id, UnitIndex,'Deal Unit', 'Temp Unit')">{{ 'Or_Set_a_temporary_unit' | translate }}</button>
                                                            <button  ng-disabled = "!GroupOnlyPermissions['Deal']['create/modify']" ng-if="!(unit.DealItemObj.UnitId == null && unit.DealItemObj.Make == null) && M_CO.isReplaceUnit" class="bp-btn bp-btn-normal" ng-click="M_CO.isReplaceUnit = false">{{ 'Cancel_Label' | translate }}</button>
                                                        </div>
                                                    </div>
                                                </div>
                                                </div>
                                            </div>
                                            <!-- End: inner Accordian level 2 -->
                                            <!-- End: Deal Unit Info accordian start here -->
                                
                                            <!-- Start: inner Accordian level 2 -->
                                            <!-- Start: Deal Unit Items accordian start here -->
                                            <div class="bp-inner-accordian second-level open dealOptionFeeGridWrapper" ng-class="{'bp-inner-accordian-opened': M_CO.expandedInner2SectionName == 'Deal_DU{{$index}}_UI'}"
                                                ng-if="unit.DealItemObj.UnitId != null || (unit.DealItemObj.UnitId == null && unit.DealItemObj.Make != null)">
                                                <div class="inner-accordian-header col-md-12" ng-click = "F_CO.expandOrCollapseInner2Section('Deal_DU'+$index+'_UISectionId', 'Deal_DU'+$index+'_UI')">
                                                    <div class="inner-accordian-header-left">
                                                        <h2 class="accordian-left-details">{{ 'Options_fees' | translate }}
                                                        <span class="badge" ng-if="M_CO.Deal.UnitList[UnitIndex].DealKitHeaderList.length > 0 && M_CO.expandedInner2SectionName != 'Deal_DU'+$index+'_UI'">{{M_CO.Deal.UnitList[UnitIndex].DealKitHeaderList.length}}</span></h2>
                                                    </div>
                                                    <div class="show-onclse" ng-if="M_CO.expandedInner2SectionName != 'Deal_DU'+$index+'_UI' && M_CO.Deal.UnitList[UnitIndex].DealKitHeaderList.length == 0" >
                                                            {{ 'You_can_add_here_additional_parts_or_options' | translate }}
                                                        </div>
                                                    <div class="accordian-right-details">
                                                        <a class="down-arrow-icon" ng-if = "M_CO.expandedInner2SectionName != 'Deal_DU'+$index+'_UI'">
                                                            <i ng-include="'{!Application_Images}/Icons/arrowDown.svg'" class="blue_008DC1"></i>
                                                        </a>  
                                                        
                                                        <a class="down-arrow-icon" ng-if = "M_CO.expandedInner2SectionName == 'Deal_DU'+$index+'_UI'">
                                                            <i ng-include="'{!Application_Images}/Icons/arrowUp.svg'" class="blue_008DC1"></i>
                                                        </a>
                                                        
                                                        <div class="accordian-right-details-text" ng-if="M_CO.expandedInner2SectionName != 'Deal_DU'+$index+'_UI'">
                                                            <p class="bp-dark-grey1-font right-text required">
                                                                <span class="bp-dark-grey1-font bp-font-16">{{ 'Label_Total' | translate }}: {{unit.TotalOptionAndFeeWithKit | currency}}</span> 
                                                            </p>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="inner-accordian-body bp-light-gray4 col-md-12 bp-collapse-div-transition P0"  id="Deal_DU{{$index}}_UISectionId"  
                                                     ng-class="{'bp-expand-div-transition': M_CO.expandedInner2SectionName == 'Deal_DU{{$index}}_UI'}">
                                                    <div class="expandableContainer PB8">
                                                        <div class="second-level-accordian__content">
                                                            <div class="table-responsive" ng-if="M_CO.Deal.UnitList[UnitIndex].DealKitHeaderList.length > 0"  ng-class = " {'PB67' : M_CO.coHeaderRec.OrderStatus === 'Closed'}">
                                                                <table class="bp-editable-table SOJobItemsGrid dealOptionFeeGrid">
                                                                    <col width="5%" />
                                                                    <col width="11%" />
                                                                    <col width="7%" />
                                                                    <col width="15%" />
                                                                    <col width="17%" />
                                                                    <col width="14%" />
                                                                    <col width="18%" />
                                                                    <col width="13%" />
                                                                    <thead>
                                                                        <tr>
                                                                            <th></th>
                                                                            <th class="bp-text-uppercase ">{{ 'Item_description' | translate }}</th>
                                                                            <th class="bp-text-uppercase text-center">{{ 'Install' | translate }}</th>
                                                                            <th class="bp-text-uppercase text-center">{{ 'Qty_needed' | translate }}</th>
                                                                            <th class="bp-text-uppercase text-center">{{ 'Label_Status' | translate }}</th>
                                                                            <th class="bp-text-uppercase text-center">{{ 'Label_Price' | translate }}</th>
                                                                            <th class="bp-text-uppercase text-center">{{ 'Label_Subtotal' | translate }}</th>
                                                                            <th></th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody ng-repeat="dealKitHeader in M_CO.Deal.UnitList[UnitIndex].DealKitHeaderList" ng-init="kitHeaderIndex = $index">
                                                                        <!-- Start: Kit Header Row -->
                                                                        <tr ng-if="dealKitHeader.Id" class="bp-expanded-deletable-div-transition kitHeaderTr bp-tr-hover bp-disabled-tr" 
                                                                            id="deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}"
                                                                            ng-click="F_CO.editDealKHItem('deal', UnitIndex, kitHeaderIndex);">
                                                                            <td ng-class="{'setBgColor' : M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}',
                                                                                'bp-disabled': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'KHItem', UnitIndex, kitHeaderIndex)}">
                                                                                <i ng-include="'{!Application_Images}/Icons/kit.svg'" class="grey bp-pointer-cursor pull-left itemSvg"></i>
                                                                            </td>
                                                                            <td class="boldText" ng-class = "{'setBgColor' : M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}',
                                                                                'bp-disabled': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'KHItem', UnitIndex, kitHeaderIndex)}">
                                                                                <div class="liItemDesc_setTextEllipsis">
                                                                                    <span class="">{{::dealKitHeader.ItemDescription}}</span>
                                                                                </div>
                                                                            </td>
                                                                            <td ng-class = "{'setBgColor' : M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}',
                                                                                'bp-bg-disabled-div': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'KHItem', UnitIndex, kitHeaderIndex)}"> <!-- ,'bp-disabled': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}' 
                                                                                                                                                                                        &&(!F_CO.displayEditBtnOnLineItem('OptionFee', 'KHItem', UnitIndex, kitHeaderIndex) -->
                                                                               <label class="bp-switch optionFeeSwitch" id="deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_IsInstallFlag">
                                                                                   <input type="checkbox" ng-disabled="dealKitHeader.IsServiceKit || !GroupOnlyPermissions['Deal']['create/modify']" 
                                                                                         ng-model="dealKitHeader.IsInstall" ng-click="F_CO.installOptionFeeAction(UnitIndex, kitHeaderIndex, null)"/>
                                                                                   <div class="bp-slider round" ng-class = "{'disableCheckBox' : (!GroupOnlyPermissions['Deal']['create/modify'] || dealKitHeader.IsServiceKit)}"></div>
                                                                                </label>
                                                                            </td>
                                                                            <td ng-class = "{'setBgColor' : M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}',
                                                                                'bp-disabled': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'KHItem', UnitIndex, kitHeaderIndex)}">
                                                                            </td>
                                                                            <td ng-class = "{'setBgColor' : M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}',
                                                                                'bp-disabled': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'KHItem', UnitIndex, kitHeaderIndex)}">
                                                                            </td>
                                                                            
                                                                            <td class="text-center" ng-class = "{'setBgColor' : M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}',
                                                                                'bp-disabled': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'KHItem', UnitIndex, kitHeaderIndex)}">
                                                                                <span ng-if = "(M_CO.editLineItem != 'deal_unit' + UnitIndex + '_kit' + kitHeaderIndex || dealKitHeader.IsFixedPrice)"
                                                                                    ng-class="{'fixedPriceWithLock': (dealKitHeader.IsFixedPrice || dealKitHeader.IsFixedPriceForCO), 'pull-left': (dealKitHeader.IsFixedPrice || dealKitHeader.IsFixedPriceForCO)}">{{::dealKitHeader.Price | currency}}</span>
                                                                                
                                                                                <span ng-if = "(M_CO.editLineItem == 'deal_unit' + UnitIndex + '_kit' + kitHeaderIndex && !dealKitHeader.IsFixedPrice)">
                                                                                    <numbers-only id-value = "deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_Price"
                                                                                        class-value = "bp-input-text inTimeEdit timeField text-center"
                                                                                        input-model-value = "dealKitHeader.Price" 
                                                                                        include-negative = "false"
                                                                                        include-zero = "true"
                                                                                        precision-length = "2"
                                                                                        blur-value = "F_CO.updateOFKHItem('deal', UnitIndex, kitHeaderIndex, $event)"
                                                                                        input-keydown-value="F_CO.setFlagOnTabForBlurHandling($event)"/>
                                                                                </span>
                                                                                <i ng-include="'{!Application_Images}/Icons/lock-fill.svg'" ng-if="(dealKitHeader.IsFixedPrice) && (M_CO.editLineItem != 'deal_unit' + UnitIndex + '_kit' + kitHeaderIndex)"
                                                                                    class="grey bp-pointer-cursor pull-left lockSvg"></i>
                                                                                <i ng-include="'{!Application_Images}/Icons/lock-fill.svg'" ng-if="(dealKitHeader.IsFixedPriceForCO) && (M_CO.editLineItem != 'deal_unit' + UnitIndex + '_kit' + kitHeaderIndex)"
                                                                                    class="grey bp-pointer-cursor pull-left lockSvg"></i>
                                                                            </td>
                                                                            <td class="text-center boldText" ng-class = "{'setBgColor' : M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}',
                                                                                'bp-disabled': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'KHItem', UnitIndex, kitHeaderIndex)}">
                                                                                <span>{{::dealKitHeader.Price | currency}}</span>
                                                                            </td>
                                                                            <td class="partInvIconAdjustment" ng-class = "{'setBgColor' : M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}',
                                                                                'bp-bg-disabled-div': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'KHItem', UnitIndex, kitHeaderIndex)
                                                                                    && (GroupOnlyPermissions['Deal']['create/modify'] && F_CO.isDealActionEnable() && (M_CO.Deal.OptionStatus === 'Required' || M_CO.Deal.OptionStatus === 'None')),
                                                                                'bp-disabled': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'KHItem', UnitIndex, kitHeaderIndex)
                                                                                    && (!GroupOnlyPermissions['Deal']['create/modify'] || !F_CO.isDealActionEnable() || (M_CO.Deal.OptionStatus !== 'Required' && M_CO.Deal.OptionStatus !== 'None'))}"> <!-- 'bp-disabled': (!GroupOnlyPermissions['Deal']['create/modify'] || !F_CO.isDealActionEnable() || (M_CO.Deal.OptionStatus !== 'Required' && M_CO.Deal.OptionStatus !== 'None')) -->
                                                                                <div class = ""  >
                                                                               <span data-toggle="tooltip" title="Delete" tooltip-loader = "tooltip-loader" ng-if = "GroupOnlyPermissions['Deal']['create/modify'] && F_CO.isDealActionEnable() && (M_CO.Deal.OptionStatus === 'Required' || M_CO.Deal.OptionStatus === 'None')" 
                                                                                id="deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_deleteBtn">
                                                                                    <i ng-include="'{!Application_Images}/Icons/trash_filled.svg'" class="icon_fill_blue bp-pointer-cursor LIDeleteBtn"
                                                                                        ng-click="F_CO.openDeleteConfirmationPopupForOptionFeeLineItem(UnitIndex, kitHeaderIndex, optionFeeIndex, M_CO.Deal.UnitList[UnitIndex].DealItemObj.Id, dealKitHeader.Id, OptionFee.Id, 'deal');"></i>
                                                                                </span>
                                                                                <span  ng-if = "!GroupOnlyPermissions['Deal']['create/modify'] || !F_CO.isDealActionEnable() || (M_CO.Deal.OptionStatus !== 'Required' && M_CO.Deal.OptionStatus !== 'None')">
                                                                                     <i ng-include="'{!Application_Images}/Icons/lock-fill.svg'"
                                                                                        class="grey lockSvg"></i>
                                                                                </span>
                                                                                </div>
                                                                            </td>
                                                                        </tr>
                                                                        <!-- End: Kit Header Row -->
                                                                        
                                                                        <!-- Start: Line Items Row with Kit Header -->
                                                                        <tr class="bp-expanded-deletable-div-transition kitLITr bp-tr-hover" id="deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{$index}}"
                                                                            ng-repeat="optionFee in dealKitHeader.OptionAndFeeList" ng-init="optionFeeIndex = $index" ng-if="dealKitHeader.Id"
                                                                            ng-click="F_CO.editOptionFee('deal', UnitIndex, kitHeaderIndex, optionFeeIndex, optionFee.PartId)">
                                                                            
                                                                            <td ng-class = "{'setBgColor' : M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' || M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}',
                                                                                'bp-disabled': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'KitLI', UnitIndex, kitHeaderIndex, optionFeeIndex)}">
                                                                            </td>
                                                                            <td class="boldText" ng-class = "{'setBgColor' : M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' || M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}',
                                                                                'bp-disabled': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'KitLI', UnitIndex, kitHeaderIndex, optionFeeIndex)}">
                                                                                <div class="liItemDesc_setTextEllipsis" 
                                                                                    ng-if="(M_CO.editLineItem != 'deal_unit' + UnitIndex + '_kit' + kitHeaderIndex + '_of' + optionFeeIndex) || (optionFee.PartId) 
                                                                                        || (F_CO.isCommitAndInstallActionDone())">
                                                                                    <i ng-include="'{!Application_Images}/Icons/part.svg'" ng-if="optionFee.PartId"
                                                                                        class="grey bp-pointer-cursor pull-left itemSvg kitItemSvg"></i>
                                                                                    <i ng-include="'{!Application_Images}/Icons/labor.svg'" ng-if="optionFee.LabourId"
                                                                                        class="grey bp-pointer-cursor pull-left itemSvg kitItemSvg"></i>
                                                                                    <i ng-include="'{!Application_Images}/Icons/fee_V2.svg'" ng-if="optionFee.FeeId"
                                                                                        class="grey bp-pointer-cursor pull-left itemSvg kitItemSvg"></i>
                                                                                    <i ng-include="'{!Application_Images}/Icons/sublet.svg'" ng-if="optionFee.ProductId"
                                                                                        class="grey bp-pointer-cursor pull-left itemSvg kitItemSvg"></i>
                                                                                    <span class="bp-blue-font" ng-class="{'bp-blue-hover' : optionFee.PartId}" 
                                                                                        ng-click="F_CO.moveToState('ViewPart',{Id:optionFee.PartId},optionFee.PartId)"
                                                                                        id="deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}_itemDesc">
                                                                                        {{::optionFee.ItemCode}} - {{::optionFee.ItemDescription}}
                                                                                   </span>
                                                                                </div>
                                                                                
                                                                                <div class="liItemDesc" ng-if="(M_CO.editLineItem == 'deal_unit' + UnitIndex + '_kit' + kitHeaderIndex + '_of' + optionFeeIndex) && (!optionFee.PartId) 
                                                                                    && (!F_CO.isCommitAndInstallActionDone())">
                                                                                    <i ng-include="'{!Application_Images}/Icons/part.svg'" ng-if="optionFee.PartId"
                                                                                        class="grey bp-pointer-cursor pull-left itemSvg kitItemSvg"></i>
                                                                                    <i ng-include="'{!Application_Images}/Icons/labor.svg'" ng-if="optionFee.LabourId"
                                                                                        class="grey bp-pointer-cursor pull-left itemSvg kitItemSvg"></i>
                                                                                    <i ng-include="'{!Application_Images}/Icons/fee_V2.svg'" ng-if="optionFee.FeeId"
                                                                                        class="grey bp-pointer-cursor pull-left itemSvg kitItemSvg"></i>
                                                                                    <i ng-include="'{!Application_Images}/Icons/sublet.svg'" ng-if="optionFee.ProductId"
                                                                                        class="grey bp-pointer-cursor pull-left itemSvg kitItemSvg"></i>
                                                                                            
                                                                                    <span class="editableDescInput editableKitDescInput">
                                                                                        <span class="itemCode">{{::optionFee.ItemCode}} - </span>
                                                                                        <input id="deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}_itemDesc"
                                                                                            class="bp-input-text text-center"
                                                                                            type="text" ng-model="optionFee.ItemDescription" 
                                                                                            ng-blur="F_CO.updateOFLineItem('deal', UnitIndex, kitHeaderIndex, optionFeeIndex, $event)"
                                                                                            ng-keydown="F_CO.setFlagOnTabForBlurHandling($event)"/>
                                                                                    </span>
                                                                                </div>
                                                                            </td>
                                                                            
                                                                            <td ng-class = "{'setBgColor' : M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' || M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}',
                                                                                'bp-disabled': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'KitLI', UnitIndex, kitHeaderIndex, optionFeeIndex)}">
                                                                            </td>
                                                                            <td class="text-center" ng-class = "{'setBgColor' : M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' || M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}',
                                                                                'bp-disabled': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'KitLI', UnitIndex, kitHeaderIndex, optionFeeIndex)}">
                                                                                <span>{{::optionFee.Qty}}</span>
                                                                            </td>
                                                                            <td class="text-center bp-bold-font" ng-class = "{'setBgColor' : M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' || M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}',
                                                                                'bp-disabled': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'KitLI', UnitIndex, kitHeaderIndex, optionFeeIndex)}">
                                                                               <span ng-if="optionFee.PartId" ng-class = "{'bp-green-font': optionFee.Status == 'In Stock','bp-red-font': optionFee.Status == 'Required', 'bp-green-dark-font': optionFee.Status == 'Invoiced'}">{{::optionFee.Status}}</span>
                                                                            </td>
                                                                            <td class="text-center" ng-class = "{'setBgColor' : M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' || M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}',
                                                                                'bp-disabled': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'KitLI', UnitIndex, kitHeaderIndex, optionFeeIndex)}">
                                                                                <span ng-if = "(M_CO.editLineItem != 'deal_unit' + UnitIndex + '_kit' + kitHeaderIndex + '_of' + optionFeeIndex
                                                                                    || !GroupOnlyPermissions['Override price'].enabled || optionFee.IsFixedPrice)"
                                                                                ng-class="{'fixedPriceWithLock': (optionFee.IsFixedPrice || optionFee.IsFixedPriceForCO), 'pull-left': (optionFee.IsFixedPrice || optionFee.IsFixedPriceForCO)}">{{::optionFee.Price | currency}}</span>
                                                                                <span ng-if = "(M_CO.editLineItem == 'deal_unit' + UnitIndex + '_kit' + kitHeaderIndex + '_of' + optionFeeIndex
                                                                                    && GroupOnlyPermissions['Override price'].enabled && !optionFee.IsFixedPrice)">
                                                                                    <numbers-only id-value = "deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}_Price"
                                                                                        class-value = "bp-input-text inTimeEdit timeField text-center"
                                                                                        input-model-value = "optionFee.Price" 
                                                                                        include-negative = "false"
                                                                                        include-zero = "true"
                                                                                        precision-length = "2"
                                                                                        blur-value = "F_CO.updateOFLineItem('deal', UnitIndex, kitHeaderIndex, optionFeeIndex, $event)"
                                                                                        input-keydown-value="F_CO.setFlagOnTabForBlurHandling($event)"/>
                                                                                </span>
                                                                                <i ng-include="'{!Application_Images}/Icons/lock-fill.svg'" ng-if="(optionFee.IsFixedPrice) && (M_CO.editLineItem != 'deal_unit' + UnitIndex + '_kit' + kitHeaderIndex + '_of' + optionFeeIndex)"
                                                                                        class="grey bp-pointer-cursor pull-left lockSvg"></i>
                                                                                <i ng-include="'{!Application_Images}/Icons/lock-fill.svg'" ng-if="(optionFee.IsFixedPriceForCO) && (M_CO.editLineItem != 'deal_unit' + UnitIndex + '_kit' + kitHeaderIndex + '_of' + optionFeeIndex)"
                                                                                    class="grey bp-pointer-cursor pull-left lockSvg"></i>
                                                                            </td>
                                                                            <td class="text-center boldText" ng-class = "{'setBgColor' : M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' || M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}',
                                                                                'bp-disabled': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'KitLI', UnitIndex, kitHeaderIndex, optionFeeIndex)}">
                                                                                <span>{{(optionFee.Qty * optionFee.Price) | currency}}</span>
                                                                            </td>
                                                                            <td class="partInvIconAdjustment" ng-class = "{'setBgColor' : M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' || M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}',
                                                                                'bp-disabled': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'KitLI', UnitIndex, kitHeaderIndex, optionFeeIndex)}">
                                                                                 <div class = "" ng-if = "GroupOnlyPermissions['Deal']['create/modify'] && GroupOnlyPermissions['Override price'].enabled
                                                                                                && M_CO.Deal.DealInfo.DealStatus != 'Invoiced' && (!OptionFee.PartId || OptionFee.Status != 'Fulfilled')">
                                                                                 </div> 
                                                                           </td>
                                                                        </tr>
                                                                        <!-- End: Line Items Row with Kit Header -->
                                                                        
                                                                        <!-- Start: Line Items Row without Kit Header -->
                                                                        <tr class="bp-expanded-deletable-div-transition bp-tr-hover bp-disabled-tr" id="deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{$index}}"
                                                                            ng-repeat="OptionFee in dealKitHeader.OptionAndFeeList" ng-init="optionFeeIndex = $index" ng-if="!dealKitHeader.Id"
                                                                            ng-click="F_CO.editOptionFee('deal', UnitIndex, kitHeaderIndex, optionFeeIndex, OptionFee.PartId)">
                                                                            <td ng-class = "{'setBgColor' : M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}',
                                                                                'bp-disabled': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'NonKitLI', UnitIndex, kitHeaderIndex, optionFeeIndex)}">
                                                                                <i ng-include="'{!Application_Images}/Icons/part.svg'" ng-if="OptionFee.PartId"
                                                                                    class="grey bp-pointer-cursor pull-left itemSvg"></i>
                                                                                <i ng-include="'{!Application_Images}/Icons/labor.svg'" ng-if="OptionFee.LabourId"
                                                                                    class="grey bp-pointer-cursor pull-left itemSvg"></i>
                                                                                <i ng-include="'{!Application_Images}/Icons/fee_V2.svg'" ng-if="OptionFee.FeeId"
                                                                                    class="grey bp-pointer-cursor pull-left itemSvg"></i>
                                                                                
                                                                                <i ng-include="'{!Application_Images}/Icons/sublet.svg'" ng-if="OptionFee.ProductId && OptionFee.ProductType == 'Sublet'"
                                                                                        class="grey bp-pointer-cursor pull-left itemSvg"></i>  
                                                                                <i ng-include="'{!Application_Images}/Icons/Warranty-product.svg'" ng-if="OptionFee.ProductId && OptionFee.ProductType == 'Warranty Plan'"
                                                                                    class="grey bp-pointer-cursor pull-left itemSvg"></i>
                                                                                <i ng-include="'{!Application_Images}/Icons/finance-product_V2.svg'" ng-if="OptionFee.ProductId && OptionFee.ProductType == 'Financing Product'"
                                                                                    class="grey bp-pointer-cursor pull-left itemSvg"></i>
                                                                                <i ng-include="'{!Application_Images}/Icons/Deal-financing_V2.svg'" ng-if="OptionFee.ProductId && OptionFee.ProductType == 'Deal Product'"
                                                                                    class="grey bp-pointer-cursor pull-left itemSvg"></i>     
                                                                            </td>
                                                                            <td class="boldText" ng-class = "{'setBgColor' : M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}',
                                                                                'bp-disabled': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'NonKitLI', UnitIndex, kitHeaderIndex, optionFeeIndex)}">
                                                                                <div class="liItemDesc_setTextEllipsis"
                                                                                    ng-if="(M_CO.editLineItem != 'deal_unit' + UnitIndex + '_kit' + kitHeaderIndex + '_of' + optionFeeIndex) 
                                                                                        || (OptionFee.PartId) || (OptionFee.ProductType == 'Warranty Plan') 
                                                                                        || (OptionFee.ProductType == 'Financing Product') || (OptionFee.ProductType == 'Deal Product') 
                                                                                        || (F_CO.isCommitAndInstallActionDone() && (OptionFee.PartId || OptionFee.LabourId || (OptionFee.ProductId && OptionFee.ProductType === 'Sublet')))">
                                                                                    <span class="bp-blue-font" ng-class="{'bp-blue-hover' : OptionFee.PartId}" 
                                                                                        id="deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}_itemDesc"
                                                                                        ng-click="F_CO.moveToState('ViewPart',{Id:OptionFee.PartId},OptionFee.PartId)">
                                                                                        {{::OptionFee.ItemCode}} - {{::OptionFee.ItemDescription}}
                                                                                    </span>
                                                                                </div>
                                                                                
                                                                                <div class="liItemDesc" ng-if="(M_CO.editLineItem == 'deal_unit' + UnitIndex + '_kit' + kitHeaderIndex + '_of' + optionFeeIndex) && (!OptionFee.PartId) 
                                                                                    && (OptionFee.ProductType != 'Warranty Plan') && (OptionFee.ProductType != 'Financing Product') && (OptionFee.ProductType != 'Deal Product') 
                                                                                    && !(F_CO.isCommitAndInstallActionDone() && (OptionFee.PartId || OptionFee.LabourId || (OptionFee.ProductId && OptionFee.ProductType === 'Sublet')))">
                                                                                    <span class="editableDescInput">
                                                                                        <span class="itemCode">{{::OptionFee.ItemCode}} - </span>
                                                                                        <input id="deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}_itemDesc"
                                                                                            class="bp-input-text text-center"
                                                                                            type="text" ng-model="OptionFee.ItemDescription"
                                                                                            ng-blur="F_CO.updateOFLineItem('deal', UnitIndex, kitHeaderIndex, optionFeeIndex, $event)"
                                                                                            ng-keydown="F_CO.setFlagOnTabForBlurHandling($event)"/>
                                                                                    </span>
                                                                                </div>
                                                                            </td>
                                                                          
                                                                            <td ng-class = "{'setBgColor' : M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}',
                                                                                'bp-bg-disabled-div': (M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' &&
                                                                                    !F_CO.displayEditBtnOnLineItem('OptionFee', 'NonKitLI', UnitIndex, kitHeaderIndex, optionFeeIndex))}"><!-- 'bp-disabled': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' 
                                                                                                                                                                                                                                                && !F_CO.displayEditBtnOnLineItem('OptionFee', 'NonKitLI', UnitIndex, kitHeaderIndex, optionFeeIndex) -->
                                                                                <span ng-if="((OptionFee.LabourId != null && OptionFee.LabourId != '')  || (OptionFee.PartId != null && OptionFee.PartId != '') || (OptionFee.ProductId != null && OptionFee.ProductId != '' && OptionFee.ProductType == 'Sublet'))">
                                                                                   <label class="bp-switch optionFeeSwitch" id="deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}_IsInstallFlag">
                                                                                      <input type="checkbox" ng-disabled="(OptionFee.LabourId != null && OptionFee.LabourId != '') || 
                                                                                            (OptionFee.ProductId != null && OptionFee.ProductId != '' && OptionFee.ProductType == 'Sublet') || !GroupOnlyPermissions['Deal']['create/modify']
                                                                                            || (OptionFee.PartId != null && OptionFee.PartId != '' && OptionFee.Status == 'Fulfilled')" 
                                                                                            ng-model="OptionFee.IsInstall" ng-click="F_CO.installOptionFeeAction(UnitIndex, kitHeaderIndex, optionFeeIndex)"/>
                                                                                      <div class="bp-slider round" ng-class = "{'disableCheckBox' :((M_CO.Deal.DealInfo.DealStatus == 'Invoiced' || 
                                                                                                                (OptionFee.LabourId != null && OptionFee.LabourId != '') || (OptionFee.ProductId != null && OptionFee.ProductId != '' 
                                                                                                                && OptionFee.ProductType == 'Sublet')) || !GroupOnlyPermissions['Deal']['create/modify'] || 
                                                                                                                (OptionFee.PartId != null && OptionFee.PartId != '' && OptionFee.Status == 'Fulfilled'))}"></div>
                                                                                        </label>
                                                                               </span>
                                                                            </td>
                                                                            <td class="text-center" ng-class = "{'setBgColor' : M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}',
                                                                                'bp-disabled': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'NonKitLI', UnitIndex, kitHeaderIndex, optionFeeIndex)}">
                                                                                <span ng-if="(M_CO.editLineItem != 'deal_unit' + UnitIndex + '_kit' + kitHeaderIndex + '_of' + optionFeeIndex)
                                                                                    || (F_CO.isCommitAndInstallActionDone() && (OptionFee.PartId || OptionFee.LabourId || (OptionFee.ProductId && OptionFee.ProductType === 'Sublet')))">
                                                                                    {{::OptionFee.Qty}}
                                                                                </span>
                                                                                <span ng-if="(M_CO.editLineItem == 'deal_unit' + UnitIndex + '_kit' + kitHeaderIndex + '_of' + optionFeeIndex) 
                                                                                    && !(F_CO.isCommitAndInstallActionDone() && (OptionFee.PartId || OptionFee.LabourId || (OptionFee.ProductId && OptionFee.ProductType === 'Sublet')))">
                                                                                    <numbers-only id-value = "deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}_Qty"
                                                                                        class-value = "bp-input-text inTimeEdit timeField text-center"
                                                                                        min-value = "0.01"
                                                                                        default-value = "1"
                                                                                        input-model-value = "OptionFee.Qty" 
                                                                                        include-negative = "false"
                                                                                        include-zero = "false"
                                                                                        precision-length = "2"
                                                                                        force-precision-length = "false"
                                                                                        blur-value="F_CO.updateOFLineItem('deal', UnitIndex, kitHeaderIndex, optionFeeIndex, $event)"
                                                                                        input-keydown-value="F_CO.setFlagOnTabForBlurHandling($event)"/>
                                                                                </span>
                                                                            </td>
                                                                            <td class="text-center bp-bold-font" ng-class = "{'setBgColor' : M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}',
                                                                                'bp-disabled': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'NonKitLI', UnitIndex, kitHeaderIndex, optionFeeIndex)}">
                                                                                <span ng-if="OptionFee.PartId" ng-class = "{'bp-green-font': OptionFee.Status == 'In Stock','bp-red-font': OptionFee.Status == 'Required', 'bp-green-dark-font': OptionFee.Status == 'Invoiced'}">{{::OptionFee.Status}}</span>
                                                                                <!-- <span ng-if="!OptionFee.PartId" ng-class = "{'bp-cyan-font': OptionFee.Status != 'Invoiced','bp-green-dark-font': OptionFee.Status == 'Invoiced'}">{{OptionFee.Status == "Invoiced"  ? "Invoiced" : "Ready" }}</span> -->
                                                                            </td>
                                                                            
                                                                            <td class="text-center" ng-class = "{'setBgColor' : M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}',
                                                                                'bp-disabled': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'NonKitLI', UnitIndex, kitHeaderIndex, optionFeeIndex)}">
                                                                                <span ng-if = "(M_CO.editLineItem != 'deal_unit' + UnitIndex + '_kit' + kitHeaderIndex + '_of' + optionFeeIndex
                                                                                                    || !GroupOnlyPermissions['Override price'].enabled)">{{::OptionFee.Price | currency}}</span>
                                                                                <span ng-if = "(M_CO.editLineItem == 'deal_unit' + UnitIndex + '_kit' + kitHeaderIndex + '_of' + optionFeeIndex
                                                                                                && GroupOnlyPermissions['Override price'].enabled)">
                                                                                    <numbers-only id-value = "deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}_Price"
                                                                                        class-value = "bp-input-text inTimeEdit timeField text-center"
                                                                                        input-model-value = "OptionFee.Price" 
                                                                                        include-negative = "false"
                                                                                        include-zero = "true"
                                                                                        precision-length = "2"
                                                                                        blur-value = "F_CO.updateOFLineItem('deal', UnitIndex, kitHeaderIndex, optionFeeIndex, $event)"
                                                                                        input-keydown-value="F_CO.setFlagOnTabForBlurHandling($event)"/>
                                                                                </span>
                                                                            </td>
                                                                            <td class="text-center boldText" ng-class = "{'setBgColor' : M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}',
                                                                                'bp-disabled': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'NonKitLI', UnitIndex, kitHeaderIndex, optionFeeIndex)}">
                                                                                <span>{{(OptionFee.Qty * OptionFee.Price) | currency}}</span>
                                                                            </td>
                                                                            
                                                                           <td class="partInvIconAdjustment" ng-class = "{'setBgColor' : M_CO.editLineItem == 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}',
                                                                                'bp-disabled': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'NonKitLI', UnitIndex, kitHeaderIndex, optionFeeIndex)
                                                                                    && (!GroupOnlyPermissions['Deal']['create/modify'] || !F_CO.isDealActionEnable() 
                                                                                            || ((dealKitHeader.Id || OptionFee.PartId || OptionFee.LabourId || (OptionFee.ProductId && OptionFee.ProductType === 'Sublet')) 
                                                                                            && (M_CO.Deal.OptionStatus !== 'Required' && M_CO.Deal.OptionStatus !== 'None'))),
                                                                                'bp-bg-disabled-div': M_CO.editLineItem !== 'deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}' 
                                                                                    && !F_CO.displayEditBtnOnLineItem('OptionFee', 'NonKitLI', UnitIndex, kitHeaderIndex, optionFeeIndex)
                                                                                    && ((GroupOnlyPermissions['Deal']['create/modify'] && F_CO.isDealActionEnable() 
                                                                                            && ((!dealKitHeader.Id && !OptionFee.PartId && !OptionFee.LabourId && (!OptionFee.ProductId || OptionFee.ProductType !== 'Sublet')) 
                                                                                            || (M_CO.Deal.OptionStatus === 'Required' || M_CO.Deal.OptionStatus === 'None'))))}"> <!-- 'bp-disabled': (M_CO.Deal.DealInfo.DealStatus === 'Invoiced' || !GroupOnlyPermissions['Deal']['create/modify'] || !F_CO.isDealActionEnable()
                                                                                                                                            || ((dealKitHeader.Id || OptionFee.PartId || OptionFee.LabourId || (OptionFee.ProductId && OptionFee.ProductType === 'Sublet'))
                                                                                                                                            && (M_CO.Deal.OptionStatus !== 'Required' && M_CO.Deal.OptionStatus !== 'None'))) -->
                                                                                   <div ng-if="M_CO.Deal.DealInfo.DealStatus != 'Invoiced'">
                                                                                       <span data-toggle="tooltip" title="Delete" tooltip-loader = "tooltip-loader" ng-if = "(GroupOnlyPermissions['Deal']['create/modify'] && F_CO.isDealActionEnable() && 
                                                                                       ((!dealKitHeader.Id && !OptionFee.PartId && !OptionFee.LabourId && (!OptionFee.ProductId || OptionFee.ProductType !== 'Sublet')) || 
                                                                                       (M_CO.Deal.OptionStatus === 'Required' || M_CO.Deal.OptionStatus === 'None')))" id="deal_unit{{UnitIndex}}_kit{{kitHeaderIndex}}_of{{optionFeeIndex}}_deleteBtn">
                                                                                            <i ng-include="'{!Application_Images}/Icons/trash_filled.svg'" class="icon_fill_blue bp-pointer-cursor LIDeleteBtn"
                                                                                                ng-click="F_CO.openDeleteConfirmationPopupForOptionFeeLineItem(UnitIndex, kitHeaderIndex, optionFeeIndex, M_CO.Deal.UnitList[UnitIndex].DealItemObj.Id, dealKitHeader.Id, OptionFee.Id, 'deal');"></i> <!-- data-target="#PayrollDeleteConfiramtionPopup" data-toggle="modal" -->
                                                                                        </span>
                                                                                         <span ng-if = "!GroupOnlyPermissions['Deal']['create/modify'] || !F_CO.isDealActionEnable() || 
                                                                                         ((dealKitHeader.Id || OptionFee.PartId || OptionFee.LabourId || (OptionFee.ProductId && OptionFee.ProductType === 'Sublet')) && 
                                                                                         (M_CO.Deal.OptionStatus !== 'Required' && M_CO.Deal.OptionStatus !== 'None'))">
                                                                                             <i ng-include="'{!Application_Images}/Icons/lock-fill.svg'" 
                                                                                                class="grey lockSvg"></i>
                                                                                        </span>
                                                                                </div>
                                                                            </td>
                                                                        </tr>
                                                                        <!-- End: Line Items Row without Kit Header -->
                                                                    </tbody>
                                                                </table>
                                                            </div>
                                                            
                                                            <div class="search-entity-wrapper" ng-if="F_CO.showAutoComplete()"
                                                                ng-class="{'pull-left autocomplete-wrapper-left': M_CO.IsARIPartSmartEnabled && !F_CO.isCommitAndInstallActionDone()}">
                                                                <p class="search-entity-text">{{ 'Scan_and_search_to_add_items' | translate }}</p>
                                                                <autocompletev2 id="autocompletev2DealId"
                                                                    template-name="Entity"
                                                                    section-name="{{F_CO.isCommitAndInstallActionDone() ? 'Committed Deal' : 'Deal'}}"
                                                                    unit-index="{{UnitIndex}}"
                                                                    section-id="DealUnit{{UnitIndex}}"
                                                                    is-disabled="!GroupOnlyPermissions['Deal']['create/modify'] || !F_CO.isDealActionEnable()" />
                                                            </div>
                                                            <div class="autocomplete-wrapper-right pull-left"
                                                                ng-if="F_CO.showAutoComplete() && M_CO.IsARIPartSmartEnabled && !F_CO.isCommitAndInstallActionDone() &&  GroupOnlyPermissions['Deal']['create/modify'] && F_CO.isDealActionEnable()">
                                                                <droplet class ="part-smart-droplet" ng-model="FileUpload.interface"> 
                                                                    <div class="search-entity-wrapper browse_but"> 
                                                                        <droplet-upload-single ng-model="FileUpload.interface" ng-click="F_CO.setPartSmartFileReadData('Deal', M_CO.Deal.UnitList[UnitIndex].DealItemObj.Id)"> 
                                                                        </droplet-upload-single> 
                                                                        <i ng-include="'{!Application_Images}/Icons/part-smart.svg'" class="icon_fill_blue bp-pointer-cursor pull-left bp-svg-15"
                                                                       ng-click="F_CO.setPartSmartFileReadData('Deal', M_CO.Deal.UnitList[UnitIndex].DealItemObj.Id)"></i>
                                                                         <a class="bp-blue-font bp-bold-font bp-font-14 pull-left line-height-small" ng-click="F_CO.setPartSmartFileReadData('Deal', M_CO.Deal.UnitList[UnitIndex].DealItemObj.Id)">
                                                                        {{ 'Add_items_with_PartSmart' | translate }}
                                                                         </a> 
                                                                   </div> 
                                                                </droplet>
                                                            </div>
                                                        </div> 
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- Start: inner Accordian level 2 -->
                                            <!-- Start: Deal Unit Items accordian start here -->
                                        </div>
                                    </div>
                                </div>
                                <!-- End: Deal Unit accordian end here -->
                                <!-- End: inner Accordian level 1 --> 
                                
                                <!-- Added for trade in -->
                                <!-- Start: Deal Trade In section -->
                                <div class="bp-inner-accordian open bp-inner-accordian-deal tradeIn"  ng-class="{'bp-inner-accordian-opened': M_CO.expandedInnerSectionName == 'Deal_TradeIn{{$index}}', 'bp-inner-accordian-opened-deal': M_CO.expandedInnerSectionName == 'Deal_TradeIn{{$index}}'}"
                                    ng-repeat = "tradeItem in  M_CO.Deal.TradeInsList track by $index" ng-init="tradeIn_Index=$index">
                                     <div class="inner-accordian-header col-md-12" ng-click = "F_CO.expandOrCollapseInnerSection('Deal_TradeInSectionId'+$index, 'Deal_TradeIn'+$index)">
                                        <div class="inner-accordian-header-left">
                                            <h2 class="accordian-left-details">{{ 'Trade_in' | translate }} {{$index + 1}}  
                                            </h2>
                                        </div>
                                        <div class="accordian-right-details">
                                            <a class="down-arrow-icon" ng-if = "M_CO.expandedInnerSectionName != 'Deal_TradeIn'+$index">
                                                <i ng-include="'{!Application_Images}/Icons/arrowDown.svg'" class="blue_008DC1"></i>
                                            </a>
                                            <a class="down-arrow-icon" ng-if = "M_CO.expandedInnerSectionName == 'Deal_TradeIn'+$index">
                                                <i ng-include="'{!Application_Images}/Icons/arrowUp.svg'" class="blue_008DC1"></i>
                                            </a>
                                             <div class="accordian-right-details-text"
                                                ng-if="GroupOnlyPermissions['Deal']['create/modify'] &&
                                                    M_CO.expandedInnerSectionName == 'Deal_TradeIn'+$index &&
                                                    F_CO.isDealActionEnable() && !tradeItem.IsSctockedIn">
                                                <p class="right-text required">
                                                    <!-- <a class="bp-blue-font bp-font-14" ng-click="F_CO.TradeIn.removeTradeItem(tradeIn_Index)">Remove trade-in</a> -->
                                                    <a data-toggle="modal" data-target="#TradeInConfirmationPopup" class="bp-font-14 bp-blue-font bp-cursor-pointer" ng-click="F_CO.openTradeInConfirmationPopup(tradeIn_Index)"
                                                        >{{ 'Text_Remove_TradeIn_From_Deal' | translate }}</a> 
                                                    <span class="icon-container" data-toggle="modal" data-target="#TradeInConfirmationPopup" ng-click="F_CO.openTradeInConfirmationPopup(tradeIn_Index)">
                                                        <i ng-include="'{!Application_Images}/Icons/trash_filled.svg'" class="icon_fill_blue bp-pointer-cursor bp-svg-19"></i>
                                                    </span>
                                                </p>
                                           </div> 
                                           <div class="accordian-right-details-text" ng-if="M_CO.expandedInnerSectionName != 'Deal_TradeIn'+$index">
                                                <p class="bp-dark-grey1-font right-text required">
                                                    <span class="bp-dark-grey1-font bp-font-16">{{ 'Label_Total' | translate }}: ({{tradeItem.AgreedValue | currency}})</span> 
                                                </p>
                                           </div> 
                                        </div>
                                    </div>
                                    
                                    <div class="inner-accordian-body bp-light-gray4 col-md-12 bp-collapse-div-transition"  
                                        id="Deal_TradeInSectionId{{$index}}"
                                        ng-if="M_CO.Deal.TradeInsList.length > 0 "
                                        ng-class="{'bp-expand-div-transition': M_CO.expandedInnerSectionName == 'Deal_TradeIn{{tradeIn_Index}}'}">
                                       <div class="expandableContainer P0">
                                            <div class="lr-pad-52" ng-If ="M_CO.Deal.TradeInsList[tradeIn_Index].UnitId != null">
                                                <div class="col-sm-6 left-container">
                                                <p class="cou-card-font bp-font-16 bp-bold-font modified-p-margin-bottom bp-font-16">{{ 'Customer_owned_unit_to_trade' | translate }}</p>
                                                    <div class="showing-customer" >
                                                        <info-card-component id-value="couInfoCardTradeIn" override-css="altered-info-card"
                                                            header-link-action="F_CO.moveToState('ViewUnit', {Id : tradeItem.UnitId}, true)"
                                                            hyperlink-action="F_CO.TradeIn.replaceTradeInUnit(tradeIn_Index)"
                                                            object-payload="M_CO.unitIdToUnitImagesJsonMap[tradeItem.UnitId].unitCardInfoPayload"
                                                            image-action="F_CO.openImageCarousel(tradeItem.UnitId)">
                                                            <div class="pt10 bp-flex-col" ng-if="M_CO.Deal.DealInfo.DealStatus != 'Quotation' && !M_CO.disableDealItemEdit() && !tradeItem.IsSctockedIn && M_CO.Deal.DealInfo.isTradeStockInActionAvailable">
                                                            <a class="bp-blue-font bp-font-14 bp-bold-font" ng-click="F_CO.TradeIn.openStockInCOUConfirmationPopup(tradeIn_Index, $event)" href="">{{ 'Label_stock_in' | translate }}</a>
                                                            </div>
                                                         </info-card-component>
                                                         
                                                         <div class="deal-tax-details" ng-if="tradeItem.UnitId != null">
                                                            <div class="row M0">
                                                                <div class="col-lg-2 col-xs-3 lables bp-bold-font bp-dark-grey1-font P0 bp-font-16">{{'ViewLabour_Taxable' | translate}}</div>
                                                                    <div class="col-lg-8 col-xs-8 values bp-dark-grey1-font">
                                                                        <label class="bp-switch"> 
                                                                            <input ng-model="tradeItem.Taxable" type="checkbox" ng-disabled="(!GroupOnlyPermissions['Sales Taxes']['assign']) || M_CO.disableDealItemEdit()"
                                                                                ng-change="F_CO.saveDealItemTaxInfo(tradeItem.Taxable, tradeItem.ApplicableTaxId, tradeItem.Id, tradeIn_Index, 'tradeIn')"/>
                                                                            <div class="bp-slider round"></div>
                                                                        </label>
                                                                    </div>
                                                                </div>
                                                                <div class="row M0" ng-if="tradeItem.Taxable">
                                                                    <label class="col-xs-12">{{'Applicable_tax_Label' | translate}}</label>
                                                                     <div class="col-lg-12 P0">
                                                                         <div class="account-type-container">
                                                                             <div class = "bp-autocomplete-Wrapper autocomplete_v2">
                                                                                 <span class = "bp-autocomplete-image-icon">
                                                                                     <i ng-include="'{!Application_Images}/Icons/arrowDown.svg'" class="bp-blue bp-cursor-pointer svg_width_2px" ng-click = "F_CO.setFocusOnInput('tradeInSalesTaxRec')"></i>
                                                                                 </span>
                                                                                 <input  type="text" id="tradeInSalesTaxRec" class="bp-autocomplete-input bp-cursor-pointer bp-input-text  manage-long-salesperson-person" placeholder="{{'Please_select' | translate }}"
                                                                                     autocomplete="off" ng-keyup="F_CO.keyPressNavigationOnDropdownElements($event, 'tradeInSalesTaxRecDropdownDiv', 'tradeInSalesTaxRec', M_CO.applicableSalesTaxList)"
                                                                                     ng-model="tradeItem.ApplicableTaxName" 
                                                                                     ng-focus = "M_CO.showSalesTaxListDropdown = true; F_CO.setDealApplicableTaxDefaultDataOnFocus(tradeItem.Id, tradeIn_Index, 'tradeIn', tradeItem.Taxable);"
                                                                                     ng-blur="M_CO.showSalesTaxListDropdown = false; F_CO.hideDropdown();" readonly="readonly" 
                                                                                     ng-disabled="(!GroupOnlyPermissions['Sales Taxes']['assign']) || M_CO.disableDealItemEdit()"/>
                                                                                 <div class = "bp-autocomplete-dropdown-wrapper" ng-if="M_CO.showSalesTaxListDropdown" id="tradeInSalesTaxRecDropdownDiv">
                                                                                     <ul>
                                                                                         <li ng-repeat="salesTax in M_CO.applicableSalesTaxList track by $index" id="tradeInSalesTaxRec_{{$index}}"
                                                                                             ng-class="{'selected-row': $index == M_CO.currentDropDownIndex}"
                                                                                             ng-mousedown="F_CO.selcectDealItemSalesTax(salesTax)">
                                                                                             <div class="form-group-info col-xs-12 P0">
                                                                                                 <span >{{salesTax.Name}}</span>
                                                                                             </div>
                                                                                         </li> 
                                                                                     </ul>
                                                                                      <ul ng-If="M_CO.applicableSalesTaxList.length == 0">
                                                                                         <li id="unitSalesTaxNoResults" class="BP_angucomplete-row-NoResults-Msg">
                                                                                             <div class="">{{'No_Results_Found' | translate}}</div>
                                                                                         </li>
                                                                                     </ul>
                                                                                 </div>
                                                                             </div>
                                                                          </div>
                                                                     </div>
                                                                 </div>
                                                             </div>
                                                    </div>
                                                    <div class="dollar-svg mt-medium">
                                                        <p class="bp-lh-19 bp-font-16 modified-p-margin-bottom">{{ 'Agreed_value' | translate }}</p>
                                                        <span class="dollar bp-grey-font">{{ 'Currency_Symbol' | translate }}</span>
                                                        <numbers-only id-value = "AgreedValueForCOU"
                                                                 class-value="bp-input-text padding-from-icon"
                                                                 input-model-value = "tradeItem.AgreedValue" 
                                                                 place-holder-value ="$"
                                                                 precision-length = "2"
                                                                 disabled-value = "M_CO.disableDealItemEdit()"
                                                                 blur-value = "F_CO.TradeIn.setAgreedValue(tradeItem.AgreedValue,tradeIn_Index)"
                                                                 input-keyup-value="F_CO.TradeIn.changeField(tradeItem.AgreedValue, oldValue)"
                                                                 focus-value="F_CO.TradeIn.copyCurrentAgreedValue(tradeIn_Index)" />
                                                   </div>
                                                   <div class="dollar-svg mt-medium" ng-if="GroupOnlyPermissions['Costs'].modify">
                                                        <p class="bp-lh-19 bp-font-16 modified-p-margin-bottom">{{ (!M_CO.coHeaderRec.IsTaxIncludedPricing ? 'Label_actual_cash_value' : 'Label_actual_cash_value_excluding_tax') | translate }}</p>
                                                        <span class="dollar bp-grey-font">{{ 'Currency_Symbol' | translate }}</span>
                                                        <numbers-only id-value = "ActualCashValueForCOU"
                                                                 class-value="bp-input-text padding-from-icon"
                                                                 input-model-value = "tradeItem.ActualCashValue" 
                                                                 place-holder-value ="$"
                                                                 precision-length = "2"
                                                                 disabled-value = "M_CO.disableDealItemEdit() || tradeItem.IsSctockedIn"
                                                                 blur-value = "F_CO.TradeIn.setActualCashValue(tradeItem.ActualCashValue, tradeIn_Index)" />
                                                   
                                                   </div>
                                                   
                                                   <div class="dollar-svg mt-medium">
                                                        <p class="bp-lh-19 bp-font-16 modified-p-margin-bottom">{{ 'Lien_payout' | translate }}</p>
                                                        <span class="dollar bp-grey-font">{{ 'Currency_Symbol' | translate }}</span>
                                                        <numbers-only id-value = "tradeInLienPayout"
                                                                 class-value="bp-input-text padding-from-icon"
                                                                 min-value = "0"
                                                                 include-zero = "true"
                                                                 include-negative = "false"
                                                                 place-holder-value ="$"
                                                                 precision-length = "2"
                                                                 input-model-value = "tradeItem.LienPayout" 
                                                                 disabled-value = "M_CO.disableDealItemEdit() || (M_CO.Deal.DealFinanceObj.Status === 'Approved')"
                                                                 blur-value = "F_CO.TradeIn.saveLienPayout(tradeItem.LienPayout,tradeIn_Index)"/>
                                                   </div>
                                                    
                                                   <div class="row M0" ng-if="tradeItem.LienPayout > 0">
                                                        <label class="col-xs-12">{{'Finance_company' | translate}}</label>
                                                        <div class="col-xs-12 P0"> 
                                                            <div class="account-type-container">
                                                                <div class = "bp-autocomplete-Wrapper autocomplete_v2">
                                                                    <span class = "bp-autocomplete-image-icon">
                                                                        <i ng-include="'{!Application_Images}/Icons/arrowDown.svg'" 
                                                                            class="bp-blue bp-cursor-pointer svg_width_2px" 
                                                                            ng-click = "F_CO.setFocusOnInput('tradeInFinanceCompany')"></i>
                                                                 </span>
                                                                 <input  type="text" id="tradeInFinanceCompany" class="bp-autocomplete-input bp-cursor-pointer 
                                                                    bp-input-text  manage-long-salesperson-person" placeholder="{{'Please_select' | translate }}"
                                                                    autocomplete="off" ng-keyup="F_CO.keyPressNavigationOnDropdownElements($event, 'tradeInFinanceCompanyDropdownDiv', 'tradeInFinanceCompany', M_CO.DealFinance.FinanceCompanyList)"
                                                                     ng-model="tradeItem.FinanceCompanyName" ng-focus = "M_CO.showFinanceCompanyDropdown = true;"
                                                                     ng-blur="M_CO.showFinanceCompanyDropdown = false; F_CO.hideDropdown();"  
                                                                     ng-disabled="M_CO.disableDealItemEdit() || (M_CO.Deal.DealFinanceObj.Status === 'Approved')" readonly="readonly" />                       
                                                                 <div class = "bp-autocomplete-dropdown-wrapper" ng-if="M_CO.showFinanceCompanyDropdown" id="tradeInFinanceCompanyDropdownDiv">
                                                                     <ul>
                                                                         <li ng-repeat="financeCompany in M_CO.DealFinance.FinanceCompanyList track by $index" id="tradeInFinanceCompany_{{$index}}"
                                                                            ng-class="{'selected-row': $index == M_CO.currentDropDownIndex}"
                                                                            ng-mousedown="F_CO.selectDealItemFinanceCompany(financeCompany, 'tradeIn', tradeIn_Index)">
                                                                             <div class="form-group-info col-xs-12 P0">
                                                                                 <span >{{financeCompany.Name}}</span>
                                                                             </div>
                                                                         </li> 
                                                                     </ul>
                                                                      <ul ng-If="M_CO.DealFinance.FinanceCompanyList.length == 0">
                                                                         <li id="tradeInFinanceCompanyNoResults" class="BP_angucomplete-row-NoResults-Msg">
                                                                             <div class="">{{'No_Results_Found' | translate}}</div>
                                                                         </li>
                                                                     </ul>
                                                                 </div>
                                                              </div>
                                                          </div>
                                                    </div>
                                                </div>
                                                </div>
                                                
                                                <div class="col-sm-6 right-container">
                                                    <div class="form-input">
                                                         <p class="print-item-label cou-card-font bp-font-16 bp-bold-font modified-p-margin-bottom bp-font-16">{{ 'Appraisal_method' | translate }}</p>
                                                        <div class="bp-cell  searchInputArea " ng-class = "{'showingOverlay' : M_CO.TradeIn.showAppraisalMethodList }">
                                                            <input  type="text" id="AppraisalMethod" class="bp-input-text searchInput" placeholder="Please select"
                                                                autocomplete="off" ng-focus = "F_CO.TradeIn.getAppraisalMethodList()" ng-blur = "F_CO.TradeIn.hideAppraisalMethodList()"
                                                                ng-model="tradeItem.AppraisalMethod" readonly="readonly"
                                                                ng-disabled="!GroupOnlyPermissions['Deal']['create/modify'] || M_CO.Deal.DealInfo.DealStatus == 'Invoiced'"
                                                                ng-keyup="M_CO.TradeIn.keyBoardavigation($event, M_CO.TradeIn.AppraisalMethodList, 'appraisalMethod',tradeIn_Index)"
                                                                />
                                                            <i ng-include="'{!Application_Images}/Icons/arrowDown.svg'" class="bp-blue downArrow" ng-click = "F_CO.setFocusOnInput('AppraisalMethod')"></i>
                                                            <div class="searchResultOverlay" id="appraisalMethodDropDownDiv">
                                                                <ul>
                                                                    <li ng-repeat="method in M_CO.TradeIn.AppraisalMethodList "
                                                                        ng-mousedown="F_CO.TradeIn.setAppraisalMethod($index,tradeIn_Index)"
                                                                        ng-class="{'selected-row': $index == M_CO.TradeIn.appraisalMethodCurrentIndex}"
                                                                        id="appraisalMethod{{$index}}">
                                                                        <div class="fullName text-capitalize">{{method}}  </div>
                                                                    </li>  
                                                                </ul> 
                                                            </div>  
                                                        </div>
                                                    </div>
                                                
                                                    <div class="form-input">
                                                        <label class="print-item-label">{{ 'Appraisal_status' | translate }}</label>
                                                        <div class="bp-cell  searchInputArea " ng-class = "{'showingOverlay' : M_CO.TradeIn.showAppraisalStatusList }">
                                                            <input  type="text" id="AppraisalStatus" class="bp-input-text searchInput bp-red-font" placeholder="Please select"
                                                                autocomplete="off" ng-focus = "F_CO.TradeIn.getAppraisalStatusList()" ng-blur = "F_CO.TradeIn.hideAppraisalStatusList()"
                                                                ng-model="tradeItem.AppraisalStatus" readonly="readonly"
                                                                ng-disabled="!GroupOnlyPermissions['Deal']['create/modify'] || M_CO.Deal.DealInfo.DealStatus == 'Invoiced'"
                                                                ng-class=" {'bp-red-font' : tradeItem.AppraisalStatus=='Pending Appraisal' , 'bp-green-font' : tradeItem.AppraisalStatus=='Appraisal Complete' }"
                                                                ng-keyup="M_CO.TradeIn.keyBoardavigation($event, M_CO.TradeIn.AppraisalStatusList, 'appraisalStatus',tradeIn_Index)"
                                                                />
                                                            <i ng-include="'{!Application_Images}/Icons/arrowDown.svg'" class="bp-blue downArrow" ng-click = "F_CO.setFocusOnInput('AppraisalStatus')"></i>
                                                            <div class="searchResultOverlay" id="appraisalStatusDropDownDiv">
                                                                <ul>
                                                                    <li ng-repeat="status in M_CO.TradeIn.AppraisalStatusList"
                                                                        ng-mousedown="F_CO.TradeIn.setAppraisalStatus($index,tradeIn_Index)"
                                                                        ng-class="{'selected-row': $index == M_CO.TradeIn.appraisalStatusCurrentIndex}"
                                                                        id="appraisalStatus{{$index}}">
                                                                        <div class="fullName text-capitalize">{{status}}</div>
                                                                    </li>  
                                                                </ul> 
                                                            </div>
                                                        </div>
                                                    </div>
                                                    
                                                    <div class="form-input">
                                                        <label class="print-item-label">{{ 'Appraisal_notes' | translate }}</label>
                                                        <div class="bp-cell  searchInputArea " >
                                                            <textArea  type="text" id="AppraisalNote" class="bp-input-text send-message-text-area" placeholder="Notes about the unit"
                                                                maxlength="255"
                                                                ng-disabled="!GroupOnlyPermissions['Deal']['create/modify'] || M_CO.Deal.DealInfo.DealStatus == 'Invoiced'"
                                                                ng-model="tradeItem.AppraisalNotes" 
                                                                ng-blur="F_CO.TradeIn.setAppraisalNotes(tradeItem.AppraisalNotes,tradeIn_Index)"
                                                                />
                                                        </div>
                                                    </div>
                                                
                                                    <div class="form-input">
                                                        <label class="print-item-label">{{ 'Approved_by' | translate }}</label> 
                                                        <div class="bp-cell  searchInputArea " ng-class = "{'showingOverlay' : M_CO.TradeIn.showApprovedList }">
                                                            <input  type="text" id="ApprovedBy" class="bp-input-text searchInput" placeholder="Please select"
                                                                autocomplete="off" ng-focus = "F_CO.TradeIn.getApprovedList()" ng-blur = "F_CO.TradeIn.hideApprovedList()"
                                                                ng-model="tradeItem.ApprovedByName" readonly="readonly"
                                                                ng-class=" {'bp-red-font' : tradeItem.ApprovedBy=='Pending Approval' }"
                                                                ng-disabled="!GroupOnlyPermissions['Deal']['create/modify'] || M_CO.Deal.DealInfo.DealStatus == 'Invoiced'"
                                                                ng-keyup="F_AddEditUnit.keyBoardavigation($event, M_CO.TradeIn.ApprovedList, 'approvedBy',tradeIn_Index)"
                                                                 />
                                                            <i ng-include="'{!Application_Images}/Icons/arrowDown.svg'" class="bp-blue downArrow" ng-click = "F_CO.setFocusOnInput('ApprovedBy')"></i>
                                                            <div class="searchResultOverlay" id="approvedByDropDownDiv">
                                                                <ul>
                                                                    <li ng-repeat="approved in M_CO.TradeIn.ApprovedList"
                                                                        ng-mousedown="F_CO.TradeIn.setApprovedBy($index,tradeIn_Index)"
                                                                        ng-class="{'selected-row': $index == M_CO.TradeIn.approvedByCurrentIndex}"
                                                                        id="approvedBy{{$index}}">
                                                                        <div class="fullName text-capitalize">{{approved.name}}</div>
                                                                    </li>  
                                                                </ul> 
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="select-customer-section unit tradeInCOUList " ng-If ="M_CO.Deal.TradeInsList[tradeIn_Index].UnitId == null || M_CO.TradeIn.IsCOUSelected">  
                                                <div class="left TradeInput">
                                                    <label class="print-item-label bp-dark-grey2-font">{{ 'Customer_owned_unit_to_trade' | translate }}</label>
                                                    <div class="bp-cell  searchInputArea " ng-class = "{'showingOverlay' : M_CO.TradeIn.showCOUList }">
                                                        <input  type="text" id="TradeIn{{tradeIn_Index}}" class="bp-input-text searchInput" placeholder="{{M_CO.TradeIn.COUList.length > 0 ? 'Please Select' : 'No customer unit to trade'}}"
                                                            autocomplete="off" ng-focus = "F_CO.TradeIn.getCOUList()" ng-blur = "F_CO.TradeIn.hideCOUList()"
                                                            ng-model="M_CO.TradeIn.selectedUnitName" 
                                                            ng-keyup="M_CO.TradeIn.keyBoardavigation($event, M_CO.COUList, 'TradeIn',tradeIn_Index)"
                                                            ng-disabled="!GroupOnlyPermissions['Deal']['create/modify'] || M_CO.Deal.DealInfo.DealStatus == 'Invoiced' || M_CO.TradeIn.COUList.length == 0"
                                                                 />
                                                        <i ng-include="'{!Application_Images}/Icons/arrowDown.svg'" class="bp-blue downArrow" ng-class = "{'bp-cursorNotAllowed': M_CO.TradeIn.COUList.length == 0}" ng-click = "F_CO.setFocusOnInput('TradeIn')"></i>
                                                        <div class="searchResultOverlay dropdown-wrapper" id="TradeInDropDownDiv" ng-class="{'JobNoResult' : M_CO.TradeIn.COUList.length == 0 }">
                                                            <ul ng-If="M_CO.COUList.length > 0">
                                                                <li ng-repeat="unitModel in M_CO.TradeIn.COUList| filter:{'FormattedName' : M_CO.TradeIn.selectedUnitName} track by $index"
                                                                   ng-mousedown="F_CO.TradeIn.selectedUnit(unitModel)"
                                                                   ng-class="{'selected-row': $index == M_CO.TradeIn.TradeInCurrentIndex}"
                                                                   id="TradeIn{{$index}}">
                                                                   <div class="customer-icon">
                                                                      <i ng-include= "'{!Application_Images}/Icons/Unit_V2.svg'" class="blue_3384FF"></i>
                                                                   </div>
                                                                   <div class="customer-info">
                                                                        <span class="bp-autocomplete-text">{{unitModel.FormattedName}}</span>
                                                                        <span class="bp-section-info">{{ 'Unit_number' | translate }}:</span>
                                                                        <span class="bp-section-info">{{unitModel.UnitId}}</span>
                                                                        <span class="bp-section-info"> - {{ 'Label_VIN' | translate }}:</span>
                                                                        <span class="bp-section-info">{{unitModel.VIN}}</span>
                                                                    </div>
                                                                    <div class = "customer-type">
                                                                        <span class="bp-autocomplete-title">{{ 'Label_Unit' | translate }}</span>
                                                                    </div>
                                                                   </li>
                                                            </ul>
                                                            <ul ng-If="M_CO.TradeIn.COUList.length == 0">
                                                                <li id="TradeInNoResults" class="BP_angucomplete-row-NoResults-Msg">
                                                                    <div class="">{{ 'No_Results_Found' | translate }}</div>
                                                                </li>
                                                            </ul>
                                                        </div> 
                                                    </div>
                                                </div>
                                                <div class="rightside MT1">
                                                    <button class="bp-btn bp-btn-normal temporary-unit-btn" ng-click="F_CO.saveTradeInUnit(tradeIn_Index)" ng-disabled="!GroupOnlyPermissions['Deal']['create/modify'] || M_CO.TradeIn.isUnitSelected">{{ 'Label_Select' | translate }}</button>
                                                </div>
                                            </div>
                                            <div class="TradeInput add-customer-owned" ng-if="GroupOnlyPermissions['Deal']['create/modify'] && (M_CO.Deal.TradeInsList[tradeIn_Index].UnitId == null || M_CO.TradeIn.IsCOUSelected)">
                                                    <a class="bp-blue-font bp-font-14 bp-bold-font" ng-click="F_CO.openAddEditTempUnitPopup(tradeItem.Id, tradeIn_Index, 'Trade In', 'COU')">{{ 'Add_a_new_customer_owned_unit' | translate }}</a>
                                            </div>
                                       </div> 
                                    </div> 
                                </div>
                                <!-- Trade in section ends -->
                                
                                 <!-- Start: Deal: Document Section -->
                                <co-document-section inner-accordian-wrapper-class-value="bp-inner-accordian bp-inner-accordian-deal open" 
                                    expand-collapse-inner-accordian="F_CO.expandOrCollapseInnerSection('Deal_DocumentSectionId', 'Deal_DocumentSection')"
                                    is-inner-section-expanded="M_CO.expandedInnerSectionName === 'Deal_DocumentSection'"
                                    inner-accordian-body-wrapper-id-value="Deal_DocumentSectionId"
                                    is-co-closed="M_CO.coHeaderRec.OrderStatus === 'Closed'"
                                    form-list="M_CO.documents.forms.deal[M_CO.Deal.DealInfo.Id]"
                                    attachment-list="M_CO.documents.attachments.deal[M_CO.Deal.DealInfo.Id]"
                                    add-form-action="F_CO.addFormsToSection(M_CO.Deal.DealInfo.Id, 'deal');"
                                    delete-form-action="F_CO.deleteFormsFromSection(formId, M_CO.Deal.DealInfo.Id, 'deal');"
                                    delete-attachment-action="F_CO.deleteAttachmentFromSection(attachmentId, M_CO.Deal.DealInfo.Id, 'deal');"
                                    print-document-action="F_CO.printDocument(docUrl, coFormId, isEditable, formEditConfig, editModalName)"
                                    attachment-file-upload-interface-modal="FileUpload.interface"
                                    set-add-attachment-data="F_CO.setAttachmentData(M_CO.Deal.DealInfo.Id, 'deal');"
                                    active-form-count="M_CO.documents.sectionNameToActiveFormCountMap['Deal']"
                                    active-forms="M_CO.documents.activeForms.deal[M_CO.Deal.DealInfo.Id]" />
                                <!-- End: Deal: Document Section -->
                                
                                 <!-- Start: Deal actions accordian start here -->
                                <div class="bp-inner-accordian open always-open deal-action bp-inner-accordian-last-child" ng-if = "F_CO.showActionSubSection('Deal')">
                                    <div class="inner-accordian-header col-md-12">
                                        <div class="inner-accordian-header-left">
                                            <h2 class="accordian-left-details">{{ 'Deal_actions' | translate }}</h2>
                                        </div>
                                        <div class="accordian-action-right"
                                            ng-if="GroupOnlyPermissions['Deal']['create/modify'] &&
                                            M_CO.Deal.DealInfo.DealStatus == 'Quotation' &&
                                            (M_CO.Deal.UnitList.length == 0 || (M_CO.Deal.UnitList.length == 1 && !M_CO.Deal.UnitList[0].DealItemObj.UnitId && M_CO.Deal.UnitList[0].DealKitHeaderList.length == 0))
                                            && !F_CO.TradeIn.isAnyCOUStocked()">
                                            <span class="icon-container" ng-click="F_CO.openConfirmationDialog('RemoveSection', false, 'Deal');">
                                                <i ng-include="'{!Application_Images}/Icons/trash_filled.svg'" class="icon_fill_blue bp-pointer-cursor bp-svg-19"></i>
                                                <span class="bp-font-14 bp-blue-font bp-cursor-pointer">{{'Remove_deal_Label' | translate }}</span>
                                            </span>
                                        </div>
                                    </div>
                                    <div class="inner-accordian-body col-md-12">
                                        <ul class="job-actions-buttons">
                                            <li ng-repeat = "dealAction in M_CO.DealAction" 
                                                id="deal_Action{{$index}}" ng-if="F_CO.displayDealAction(dealAction)" ng-click="F_CO.dealActionToBePerformed(dealAction)"
                                                ng-class = "{'disableDealAction':F_CO.disabledDealAction(dealAction)}">
                                                <a>
                                                    <i ng-include="'{!Application_Images}/Icons/Add.svg'" class="violet_dark purple_dark bp-pointer-cursor"></i> 
                                                    {{ dealAction | translate }}
                                                </a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <!-- End: Deal actions accordian end here -->
                             </div>
                        </div>
                    </div>
                    <!-- End: unit deal -->
</apex:component>