<apex:page doctype="html-5.0" standardStylesheets="false" showChat="false" showHeader="false" sidebar="false" 
            controller="NewHomePageCtrl" applyBodyTag="false" applyHtmlTag="false"
            extensions="NewViewCustomerCtrl,ViewVendorCtrl,PartOverviewCtrl,ViewKitCtrl,ViewLabourCtrl,ViewFeeCtrl,ViewCustomerCtrl,HomeSearchCtrl,HomeSearchPageCtrl,ViewVendorRelatedListCtrl,ViewPartCtrl,ViewPartRelatedListCtrl,VendorOrderReceivingCtrl,VendorInvoicingCtrl,ViewUnitCtrl,CustomerOrderCtrl,AutoCompleteCtrl,VendorOrderCtrl,AccountingIntegrationSettingsCtrl,UserSettingCtrl,PriceFileImportCtrl,AccountingExportCtrl,COAImportCtrl,AddeditCategoryCtrl,JobSchedulingCtrl,LinkedFeeController,TagManagementCtrl,ReturnVOCtrl,PrintCustomerOrderInvoiceCtrl,CashReconciliationCtrl,JobClockingCtrl,PayrollCtrl,CustomerOrderCtrl_V2,UnitOrderingCtrl,AddCustomerCtrl_V2,AppointmentCtrl,AddEditTechnicianScheduleCtrl,SchedulerCtrl,BarcodePrintCtrl,FormRepositoryCtrl,CustomerMessageAndEmailCtrl,LinkedFormController,FusionMappingCtrl,FusionBenchmarkingCtrl,CashDrawerCtrl,BRPDealersController">
    <html>
        <head>
            <!-- <base href="https://na35.salesforce.com/apex/Blackpurl/"/> --><!-- https://na35.salesforce.com/apex/Blackpurl -->
            <title ng-bind="pageTitle"></title>
            <link rel="shortcut icon" href="http://cdn.blackpurl.com/wp-content/uploads/2017/09/favicon.ico" type="image/x-icon"/>
            <link rel="icon" href="https://cdn.blackpurl.com/wp-content/uploads/2017/06/cropped-Favicon-32x32.png"/>
            <link rel="icon" href="https://cdn.blackpurl.com/wp-content/uploads/2017/06/cropped-Favicon-192x192.png"/>
            <link rel="apple-touch-icon-precomposed" href="http://cdn.blackpurl.com/wp-content/uploads/2017/09/apple-touch-icon.png"/>
            <meta name="msapplication-TileImage" content="https://cdn.blackpurl.com/wp-content/uploads/2017/06/cropped-Favicon-270x270.png" />
            <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
            <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,400i,600" rel="stylesheet"></link>
            <c:CSSFiles Application="{!Application}" Application_Images="{!Application_Images}" Assests="{!Assests}" />
             <link href="https://fonts.googleapis.com/css?family=Barlow:300,400,600" rel="stylesheet" />
		         <apex:includeScript value="{!Assests}/Js/Jquery.min.js" /> 
		     <apex:includeScript value="{!Assests}/Js/angular.min.js" /> 
		     <apex:includeScript value="{!Application}/Js/Other/util.js" />
        </head> 
        <body ng-cloak="ng-cloak">
        <div class="bp-preloader-wrap">
          <div class="percentage">
             <div class="glow"></div>
              <div class="percentage-number" >
                <span class="loader-title">Loading your data... </span>
                <span id="precent"></span>
            </div>
          </div>
          <div class="loader">
            <img src="https://static.thenounproject.com/png/9594-200.png" class="light-bolt" />
            <div class="trackbar">
              <div class="loadbar"></div>
            </div>
          </div>
        </div>
            <c:BPGlobalHeader Application_Images="{!Application_Images}" rendered="{!!IsLoadNewHeader}"/>
             <c:BPHeader Application="{!Application}" Application_Images="{!Application_Images}"  Assests="{!Assests}" rendered="{!IsLoadNewHeader}"/>
            <c:SearchToAdd /> 
            <c:CustomLabels />
            <!-- <c:CustomSearchToAdd />  -->
            <route-loading-indicator></route-loading-indicator>
             <div id = "BP_Home_mainContainer" class = "mainSectionView" ng-class = "{'bp-hideMobileView'  : loadHtmlViewBasedOnCurrentState()}">
                <div class="fadein viewA" ui-view="a" autoscroll='false'></div>
                <div class="fadein" ui-view="b" autoscroll='false'></div>
            </div>
            <div class = "mobileSectionView" ng-class = "{'bp-showMobileView' : loadHtmlViewBasedOnCurrentState()}">
               <div class="content bp-wrapper-container customer-orderv2 cleaning-container">
                <div class="container cleaning-page">
                    <div class="swipe_icon">
                        <i ng-include="'{!Application_Images}/Icons/broom.svg'" class="white_FFF_NewCO"></i>
                    </div>
                    <div class="cleaning_text">
                        We are still cleaning up this page for mobile devices
                    </div>
                    <div class="cleaning_button">
                    
                        <!-- <button class = "bp-btn bp-btn-secondaryCTA bp-btn-small">BACK</button> -->
                         <a ui-sref="homePage" class="back_btn bp-btn bp-btn-secondaryCTA bp-btn-small">BACK</a> 
                    </div>
                </div>
            </div>
            </div>
        </body>
        
        <script> 
            /* Start: NewHomePageCtrl var */
            window.$Global = window.$Global || {};
            $Global.origin = window.location.origin;
            $Global.IsTrialOrg = '{!IsTrialOrg}';
            $Global.communityURL = '{!JSENCODE(communityURL)}';
            $Global.communityquestionURL = '{!JSENCODE(communityquestionURL)}';
            $Global.communitycaseURL = '{!JSENCODE(communitycaseURL)}';  
            $Global.IsSystemSettingVisited = '{!IsSystemSettingVisited}';
            $Global.IsSampleDataAvailable = '{!IsSampleDataAvailable}';
            $Global.TrailOrgDays = '{!TrailOrgDays}';
            $Global.userGroupName = '{!userGroupName}';
            $Global.userGroupId = '{!userGroupId}'; 
            $Global.userGroupColor = '{!userGroupColor}'; 
            $Global.currentUserId = '{!$User.Id}';
            $Global.IsLoadNewCustomerOrder = {!IsLoadNewCustomerOrder};
            $Global.IsDP360SyncEnabled = {!IsDP360SyncEnabled};
            $Global.IsARIPartSmartEnabled = {!IsARIPartSmartEnabled};
            $Global.IsFusionMappingEnabled = {!IsFusionMappingEnabled};
            $Global.isTaxIncludingPricing = {!isTaxIncludingPricing};
            $Global.IsQBEnabled = {!IsQBEnabled};
            
            $Global.IsLoadTechScheduling = {!IsLoadTechScheduling};
            $Global.SchedulingStartDay = {!SchedulingStartDay};         
            /* End: NewHomePageCtrl var */
            $Global.UserFirstName = '{!JSENCODE($User.FirstName)}';     
            $Global.UserLastName = '{!JSENCODE($User.LastName)}';
            $Global.DateFormat = "{!JSENCODE(dateFormat)}";
            $Global.ExtendedDateFormat = "{!JSENCODE(ExtendedDateFormat)}";
            $Global.SchedulingDateFormat = "{!JSENCODE(SchedulingDateFormat)}";
            $Global.CompanyLocale = "{!JSENCODE(companyLocale)}"; 
            $Global.CurrentUserTZSIDKey = '{!JSENCODE(currentUserTZSIDKey)}';
            /* Start: NewViewCustomer var */
            $Global.MapAPIKey = '{!MapAPIKey}'; 
            $Global.Related_List_Page_Size = '{!JSENCODE(TEXT(Related_List_Page_Size))}';
            $Global.Home_Search_Grid_Page_Size = '{!JSENCODE(TEXT(Home_Search_Grid_Page_Size))}';
            /* End: NewViewCustomer var */
            /* START: Cashsale Co page */
            $Global.Cash_Paymenmt_Rounding_Factor = '{!JSENCODE(TEXT(Cash_Paymenmt_Rounding_Factor))}';
            /* END: Cashsale Co page */
            $Global.ApplicationPath = '{!JSENCODE(Application)}';
            $Global.ApplicationImagePath = '{!JSENCODE(Application_Images)}';
            $Global.AssetsPath = '{!JSENCODE(Assests)}';
            /* Start: Vendor Order */
            $Global.isPermittedToEditVOHeader = '{!isPermittedToEditVOHeader}';
            /* End: Vendor Order */
            /* Start: Customer Order */
            $Global.Sales_Tax_Rate = '{!JSENCODE(TEXT(Sales_Tax_Rate))}';
            /* End: Customer Order */            
            $Global.applicationPath = '{!JSENCODE(Application)}';
            $Global.UserLanguage = "{!JSENCODE(UserLanguage)}";
            $Global.LocalePath = '{!JSENCODE(Locale)}';
            $Global.Permission = JSON.parse('{!JSENCODE(Permission)}');
            
            $Global.isBRPEnabled = false;
            getActiveIntegrationList();
            
            //Added by Nikhil - 05/09/17 #Logout Issue  
            function validateSessionForRequireScript(){
            // make AJAX request to the remote service   
             
                Visualforce.remoting.Manager.invokeAction(
                '{!$RemoteAction.NewHomePageCtrl.validateLoginSession}',
                function (result, event) {
                    if (event.type == 'exception') {
                        handleExceptions(event);
                    }
                }, {
                    escape : true
                });
            }
            
            function getActiveIntegrationList() {
            	// make AJAX request to the remote service
                Visualforce.remoting.Manager.invokeAction(
                '{!$RemoteAction.NewHomePageCtrl.getActiveIntegrationList}',
                function (result, event) {
                    if (event.type == 'exception') {
                        handleExceptions(event);
                    } else {
		            	setActiveItegrations(parseJSON(decodeString(result)));
		            }
                }, {
                    escape : true
                });
            }
            
            function setActiveItegrations(activeIntegrationsList) {
            	$Global.isBRPEnabled = activeIntegrationsList.includes('BRP');
            }
            
            //new loader #3096 : Added by Salman
            var width = 100,
            perfData = window.performance.timing, // The PerformanceTiming interface represents timing-related performance information for the given page.
            EstimatedTime = -(perfData.loadEventEnd - perfData.navigationStart),
            time = parseInt((EstimatedTime/1000)%60)*100;

        // Loadbar Animation
        $(".loadbar").animate({
          width: width + "%"
        }, time);
        
        // Loadbar Glow Animation
        $(".glow").animate({
          width: width + "%"
        }, time);
        
        // Percentage Increment Animation
        var PercentageID = $("#precent"),
                start = 0,
                end = 100,
                durataion = time;
                animateValue(PercentageID, start, end, durataion);
                
        function animateValue(id, start, end, duration) {
          
            var range = end - start,
              current = start,
              increment = end > start? 1 : -1,
              stepTime = Math.abs(Math.floor(duration / range)),
              obj = $(id);
            
            var timer = setInterval(function() {
                current += increment; 
                $(obj).text(current + "%");
              //obj.innerHTML = current;
                if (current == end) {
                    clearInterval(timer);
                }
            }, stepTime);
        }
        
        // Fading Out Loadbar on Finised
        setTimeout(function(){
            $('.bp-preloader-wrap').fadeOut(300);
        }, (time*1.3)); //add some more delay;
            
        </script> 
        <c:JsFiles Application="{!Application}" Application_Images="{!Application_Images}" Assests="{!Assests}" />
        <c:MainJs Application="{!Application}" Application_Images="{!Application_Images}" Assests="{!Assests}" />
         <link ng-repeat="cssFile in getCssFilesBasedOnCurrentState() track by $index" ng-href="{!Application}/css/{{cssFile}}" rel="stylesheet"/>
    </html>
</apex:page>
